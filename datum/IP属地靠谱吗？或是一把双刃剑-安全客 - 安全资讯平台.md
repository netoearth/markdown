![](https://p5.ssl.qhimg.com/t01c12ee12f2d29fa46.jpg)

近期，大量社交平台上线展示IP属地的功能，根据最近发博、发评、投票等通讯时的IP地址判定所属地区，国内显示到省份/地区，国外显示到国家，且用户无法关闭该功能。

据悉，这是为了减少冒充热点事件当事人、恶意造谣、蹭流量等不良行为，确保传播内容的真实、透明。但IP属地可以被轻易伪造，无法分辨IP属地真伪，可能会使这一功能本末倒置，让不良信息的可信度增加。

## IP地址

#### 什么是IP地址

IP地址相当于网络世界的门牌号。数据在网络上传输时，依赖这个门牌号找到正确的传输方向。因此，为了接入互联网，设备需要拥有一个公网IP地址。

#### 公网IP地址

设备可以直接使用公网IP地址进行通信：

![](https://p0.ssl.qhimg.com/t01221c33825cac3000.png)

#### 内网IP地址

但是IP地址资源有限，为每一个设备分配公网IP不现实，且存在安全隐患。目前广泛使用的IPv4和过渡期试用的IPv6协议，二者除格式不同，后者的空间比前者大2^96倍，基本无其它区别，下文将针对IPv4展开介绍。

为解决IP地址资源有限的问题，往往通过路由器和NAT等相关技术，实现多设备共有同一公网IP地址，路由器充当传达室，为设备分配内网IP地址，一方面允许路由器下所有设备相互通信，另一方面允许路由器下设备与互联网通信。

![](https://p2.ssl.qhimg.com/t013de1e5cfa527f718.png)

内网IP地址相当于公司内部房间号，对应的公网IP地址可理解为公司地址。在设备接入网络时，我们很容易在其下属设备的网络信息中找到形如10._._._、172.16-31._._、192.168._.\*的内网IP地址，接入不同网络环境时的同一设备将获得不同的内网IP地址（也可能相同），不同网络环境下的相同IP地址也代表其下属的不同设备。

在内网通信时使用内网IP地址，在与互联网通信时对路由器使用内网IP地址，路由器对外使用公网IP地址。

#### 如何通过IP地址查归属地

查询IP属地都是通过公网IP地址实现的。

我们显然无法仅通过一个房间号判断其所在位置，但通过公司地址可以。区别于GPS定位和移动数据网络定位（信号塔三角定位）等，在通过IP地址查询归属地的过程中不借用任何设备信息，而是通过一个庞大的数据库。

如同固定电话的区号，IP地址的前若干位相同的IP地址被称为一个IP段，这个IP段内的IP有相同用途。通过维护一个包含所有公网IP地址的数据库，我们就可以了解到某个IP的注册机构、用途、地理位置等。

![](https://p3.ssl.qhimg.com/t01e00504c75778d6c3.png)

#### IP属地可信吗

对于正常在网络冲浪的大家，无法决定IP属地。但是通过某些手段，可以更改在网络冲浪时的IP地址。

![](https://p4.ssl.qhimg.com/t0184c2fd55dbdcb710.png)

#### 滥用HTTP报头（管理员可以规避风险）

在使用HTTP(S)协议访问网页时，可以通过在HTTP请求报头中添加首部字段X-Forwarded-For（即对应图中首部字段名为X-Forwarded-For，值为想要伪造的IP）来实现IP属地的改变。这个参数一般用于使用代理服务器后，主动向服务器报告的原始IP，大多数情况不会用到该参数。如果滥用这个参数，可以伪造一个任意的IP地址。但是一般情况下，服务器对于该参数不予以置信，而是信任IP报头中的源地址。

![](https://p4.ssl.qhimg.com/t017cc118bfabe1abe4.png)

IP报头中的目的地址和源地址是为了保证TCP通讯时双方进行三次握手和四次挥手，之后才可以进行HTTP通讯，如果更改了源地址将导致无法正常通讯。

#### 代理服务器（管理员难发现且检测花费高）

代理服务器相当于一个中转站。当使用代理服务器时，所有流量都先经过代理服务器，再由代理服务器发出，使IP属地显示代理服务器的IP属地，这种操作俗称VPN（特指代理服务器位于境外时），网络攻防术语中称作跳板。

实现这一操作只需租赁某地机房，将其作为代理服务器，就能轻易获得该地的IP属地。

如果想判断一个人是否使用的代理服务器，可以维护一个包含所有机房IP段的数据库，而要保障数据库信息实时、准确，需要花费高昂的费用。但即便如此，也难以完全解决问题，如果黑客入侵并控制了某台接入家庭宽带设备，或者购买4G上网卡后将设备藏匿于某地，将其作为代理服务器，则很难被发现。

![](https://p0.ssl.qhimg.com/t0197608785e7aa0080.png)

#### 结语

诚然，显示IP归属地一定程度上可以帮助网友更好地鉴别信息的真实性，进一步保障个人信息安全。但不难看出，通过特定技术手段，IP属地几乎可以随意更改，展示的IP属地并不完全可信，如果有人恶意利用该机制，伪造IP属地发布不实言论，故意煽动地域战争，冒充热门事件当事人、造谣等增加负面消息的可信度，甚至可能导致代理服务器等灰色畸形产业“蓬勃发展”。

因此，在日益复杂的网络环境中，了解更多网络安全知识，提升自身鉴别信息真伪的能力尤为重要。IP属地功能还在不断完善，网络不是法外之地，如果通过代理服务器等方式伪造IP属地违法乱纪，将承担相应的法律责任。净化网络生态，捍卫网络良序，需要网络管理者与您的一同努力。

#### IP地址查询网站

网络上相关工具有很多，在这里列举部分，可供感兴趣的读者进行测试。

[https://tool.lu/ip/](https://tool.lu/ip/) 整合多个平台  
[https://ipip.net/](https://ipip.net/) 国内最精准的IP库之一，提供付费服务  
[https://ip.chinaz.com/](https://ip.chinaz.com/) 多数网络从业人员工具  
[https://www.ip138.com/](https://www.ip138.com/) 与百度合作（也可直接百度“IP”）  
[https://www.ip.cn/](https://www.ip.cn/) 简单易记  
[http://www.cip.cc/](http://www.cip.cc/) 命令行下使用最佳  
[http://www.ip111.cn/](http://www.ip111.cn/) 多节点全方位查询

更多内容请关注公众号”墨云安全“