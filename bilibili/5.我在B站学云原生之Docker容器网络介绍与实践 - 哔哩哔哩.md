**æœ¬ç« ç›®å½•:**

0x04 Docker ç½‘ç»œç®¡ç†

-   1.å®¹å™¨ç½‘ç»œåŸç†
    
-   2.å®¹å™¨ç½‘ç»œå®è·µ
    
-   3.é«˜çº§ç½‘ç»œé…ç½®
    

![](https://i0.hdslb.com/bfs/article/4aa545dccf7de8d4a93c2b2b8e3265ac0a26d216.png@progressive.webp)

æè¿°: å¤§é‡äº’è”ç½‘æœåŠ¡åŒ…æ‹¬å¤šä¸ªæœåŠ¡ç»„ä»¶å¾€å¾€éœ€è¦å¤šä¸ªå®¹å™¨ä¹‹é—´è¿›è¡Œç½‘ç»œé€šä¿¡ç›¸äº’é…åˆ,Dockerç›®å‰æä¾›äº†æ˜ å°„å®¹å™¨ç«¯å£ä¸å®¿ä¸»ä¸»æœºå’Œå®¹å™¨äº’è”æœºåˆ¶æ¥ä¸ºå®¹å™¨æç½‘ç»œæœåŠ¡;å¹¶ä¸”é‡‡ç”¨Linuxç³»ç»ŸçŸ¥é“çš„ç½‘ç»œç³»ç»Ÿæ¥å®ç°å¯¹ç½‘ç»œæœåŠ¡çš„æ”¯æŒä½¿ä¹‹èƒ½æä¾›ç¨³å®šæ”¯æŒä»¥åŠå¿«é€Ÿçš„é«˜æ€§èƒ½è½¬å‘;

æè¿°: å½“ Docker å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åœ¨ä¸»æœºä¸Šåˆ›å»ºä¸€ä¸ª docker0 è™šæ‹Ÿç½‘æ¡¥ï¼Œå®é™…ä¸Šå®ƒæ˜¯ Linux çš„ä¸€ä¸ª bridge (ç½‘æ¡¥)ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè½¯ä»¶äº¤æ¢æœºï¼Œå®ƒä¼šåœ¨æŒ‚è½½åˆ°å®ƒçš„ç½‘å£ä¹‹é—´è¿›è¡Œè½¬å‘ã€‚  
åŒæ—¶ï¼ŒDocker éšæœºåˆ†é…ä¸€ä¸ªæœ¬åœ°æœªå ç”¨çš„ç§æœ‰ç½‘æ®µï¼ˆåœ¨ RFC1918 ä¸­å®šä¹‰ï¼‰ä¸­çš„ä¸€ä¸ªåœ°å€ç»™ docker0 æ¥å£

-   æ¯”å¦‚å…¸å‹çš„ 172.17.42.1ï¼Œæ©ç ä¸º 255.255.0.0
    

Docker å°±åˆ›å»ºäº†åœ¨ä¸»æœºå’Œæ‰€æœ‰å®¹å™¨ä¹‹é—´ä¸€ä¸ªè™šæ‹Ÿå…±äº«ç½‘ç»œ  
å½“åˆ›å»ºä¸€ä¸ª Docker å®¹å™¨çš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šåˆ›å»ºäº†ä¸€å¯¹ veth pair æ¥å£ï¼ˆå½“æ•°æ®åŒ…å‘é€åˆ°ä¸€ä¸ªæ¥å£æ—¶ï¼Œå¦å¤–ä¸€ä¸ªæ¥å£ä¹Ÿå¯ä»¥æ”¶åˆ°ç›¸åŒçš„æ•°æ®åŒ…ï¼‰, è¿™å¯¹æ¥å£

-   ä¸€ç«¯åœ¨å®¹å™¨å†…å³ eth0ï¼›
    
-   å¦ä¸€ç«¯åœ¨æœ¬åœ°å¹¶è¢«æŒ‚è½½åˆ° docker0 ç½‘æ¡¥ï¼Œåç§°ä»¥ veth å¼€å¤´ï¼ˆä¾‹å¦‚ vethAQI2QTï¼‰
    

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸»æœºå¯ä»¥è·Ÿå®¹å™¨é€šä¿¡ï¼Œå®¹å™¨ä¹‹é—´ä¹Ÿå¯ä»¥ç›¸äº’é€šä¿¡ã€‚  

![WeiyiGeek.Dockerç½‘ç»œ](https://i0.hdslb.com/bfs/article/ebb21e882562de8d806d35c7d807308d3aa12d57.png@863w_549h_progressive.webp)

ä¾‹å¦‚, å½“åœ¨ä¸€å°æœªç»è¿‡ç‰¹æ®Šç½‘ç»œé…ç½®çš„centos æˆ– ubuntuæœºå™¨ä¸Šå®‰è£…å®Œdockerä¹‹å, åœ¨å®¿ä¸»æœºä¸Šé€šè¿‡ifconfigå‘½ä»¤å¯ä»¥çœ‹åˆ°å¤šäº†ä¸€å—åä¸ºdocker0çš„ç½‘å¡;ä¸éš¾æƒ³åˆ°docker0å°±ä¸åªæ˜¯ä¸€ä¸ªç®€å•çš„ç½‘å¡è®¾å¤‡äº†è€Œæ˜¯ä¸€ä¸ªç½‘æ¡¥ã€‚

```
$ifconfig
docker0: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500
        inet 172.18.0.1  netmask 255.255.0.0  broadcast 172.18.255.255
$route -n
172.18.0.0      0.0.0.0         255.255.0.0     U     0      0        0 docker0

#ä¸‹å›¾å³ä¸ºDockeré»˜è®¤ç½‘ç»œæ¨¡å¼ï¼ˆbridgeæ¨¡å¼ï¼‰ä¸‹çš„ç½‘ç»œç¯å¢ƒæ‹“æ‰‘å›¾,åˆ›å»ºäº†docker0ç½‘æ¡¥,å¹¶ä»¥eth pairè¿æ¥å„å®¹å™¨çš„ç½‘ç»œ,å®¹å™¨ä¸­çš„æ•°æ®é€šè¿‡docker0ç½‘æ¡¥è½¬å‘åˆ°eth0ç½‘å¡ä¸Šã€‚
#ç½‘æ¡¥(ç­‰åŒäºäº¤æ¢æœº)

#åœ¨Linuxä¸­,å¯ä»¥ä½¿ç”¨brctlå‘½ä»¤æŸ¥çœ‹å’Œç®¡ç†ç½‘æ¡¥ï¼ˆéœ€è¦å®‰è£…bridge-utilsè½¯ä»¶åŒ…ï¼‰,æ¯”å¦‚æŸ¥çœ‹æœ¬æœºä¸Šçš„Linuxç½‘æ¡¥ä»¥åŠå…¶ä¸Šçš„ç«¯å£ï¼š
$yum install bridge-utils
$brctl show
bridge name     bridge id               STP enabled     interfaces
br-63791a62ad5a   8000.024258a66d6e       no        veth4ce6e0e
                                                    vethe5abf0f
br-6cde78afe495   8000.02420a2496c6       no      veth93e8dc0
                                                  vethfda7b14
docker0   8000.024216e63d3c       no

#docker0ç½‘æ¡¥æ˜¯åœ¨Docker daemonå¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºçš„,å…¶IPé»˜è®¤ä¸º172.18.0.1/16,ä¹‹ååˆ›å»ºçš„Dockerå®¹å™¨éƒ½ä¼šåœ¨docker0å­ç½‘çš„èŒƒå›´å†…é€‰å–ä¸€ä¸ªæœªå ç”¨çš„IPä½¿ç”¨,å¹¶è¿æ¥åˆ°docker0ç½‘æ¡¥ä¸Šã€‚

#é™¤äº†ä½¿ç”¨docker0ç½‘æ¡¥å¤–,è¿˜å¯ä»¥ä½¿ç”¨è‡ªå·±åˆ›å»ºçš„ç½‘æ¡¥,æ¯”å¦‚åˆ›å»ºä¸€ä¸ªåä¸ºbr0çš„ç½‘æ¡¥,é…ç½®IPï¼š
brctl  addbr br0
ifconfig  br0 18.18.0.1

#åœ¨Dockerå®¹å™¨å’Œå¤–ç•Œé€šä¿¡çš„è¿‡ç¨‹ä¸­,è¿˜æ¶‰åŠäº†æ•°æ®åŒ…åœ¨å¤šä¸ªç½‘å¡é—´çš„è½¬å‘ï¼ˆå¦‚ä»docker0ç½‘å¡è½¬å‘åˆ°å®¿ä¸»æœºens160ç½‘å¡ï¼‰
#éœ€è¦å†…æ ¸å°†ip-forwardåŠŸèƒ½æ‰“å¼€å³å°†ip_forwardç³»ç»Ÿå‚æ•°è®¾1
echo 1 > /proc/sys/net/ipv4/ip_forward
```

![WeiyiGeek.bridgeæ¨¡å¼å›¾](https://i0.hdslb.com/bfs/article/f5f98660db28bf4113d4e89bd69747376be92047.png@942w_554h_progressive.webp)

**ç½‘ç»œé©±åŠ¨æ¨¡å‹**

åœ¨Dockeråœ¨1.9ç‰ˆæœ¬ä¸­networkå­å‘½ä»¤å’Œè·¨ä¸»æœºç½‘ç»œæ”¯æŒ,ä¸ºäº†æ ‡å‡†åŒ–ç½‘ç»œçš„é©±åŠ¨å¼€å‘æ­¥éª¤å’Œæ”¯æŒå¤šç§ç½‘ç»œé©±åŠ¨,Dockerå…¬å¸åœ¨libnetworkä¸­ä½¿ç”¨äº†CNMï¼ˆContainer Network Modelï¼‰å®šä¹‰äº†æ„å»ºå®¹å™¨è™šæ‹ŸåŒ–ç½‘ç»œçš„æ¨¡å‹ã€‚  
libnetworkå’ŒDocker daemonåŠå„ä¸ªç½‘ç»œé©±åŠ¨çš„å…³ç³»å›¾ï¼š  
Docker daemoné€šè¿‡è°ƒç”¨libnetworkå¯¹å¤–æä¾›çš„APIå®Œæˆç½‘ç»œçš„åˆ›å»ºå’Œç®¡ç†ç­‰åŠŸèƒ½,libnetwrokä¸­åˆ™ä½¿ç”¨äº†CNMæ¥å®Œæˆç½‘ç»œåŠŸèƒ½çš„æä¾›;  

![WeiyiGeek.](https://i0.hdslb.com/bfs/article/7c8b371324764ef9d4a240b4309e036c4da1635a.png@942w_515h_progressive.webp)

CNMä¸­ä¸»è¦æœ‰æ²™ç›’ï¼ˆsandboxï¼‰ã€ç«¯ç‚¹ï¼ˆendpointï¼‰ã€ç½‘ç»œï¼ˆnetworkï¼‰3ç§ç»„ä»¶:

-   (1)Sandbox:åŒ…å«äº†ä¸€ä¸ªå®¹å™¨ç½‘ç»œæ ˆçš„ä¿¡æ¯,å®ç°å¯¹å®¹å™¨çš„æ¥å£ã€è·¯ç”±å’ŒDNSè®¾ç½®ç­‰è¿›è¡Œç®¡ç†;
    
-   (2)Endpoint:å®ƒå¯ä»¥åŠ å…¥ä¸€ä¸ªæ²™ç›’å’Œä¸€ä¸ªç½‘ç»œ,ä¸”ä¸€ä¸ªç«¯ç‚¹åªå¯ä»¥å±äºä¸€ä¸ªç½‘ç»œå¹¶ä¸”åªå±äºä¸€ä¸ªæ²™ç›’;
    
-   (3)Network:å¯ä»¥ç›´æ¥äº’ç›¸è”é€šçš„ç«¯ç‚¹(åŒ…å«å¤šä¸ªç«¯ç‚¹),ç½‘ç»œçš„å®ç°å¯ä»¥æ˜¯Linux bridgeã€VLANç­‰
    

libnetworkå…±æœ‰5ç§å†…ç½®é©±åŠ¨ï¼šbridgeé©±åŠ¨ã€hosté©±åŠ¨ã€overlayé©±åŠ¨ã€remoteé©±åŠ¨ã€nullé©±åŠ¨ã€‚

-   (1)bridgeé©±åŠ¨: Dockeré»˜è®¤è®¾ç½®é©±åŠ¨,å®ƒå¯ä»¥å°†åˆ›å»ºå‡ºæ¥çš„Dockerå®¹å™¨è¿æ¥åˆ°Dockerç½‘æ¡¥å¸¸è§„æ–¹æ³•èƒ½æ»¡è¶³å®¹å™¨åŸºç¡€éœ€æ±‚,ç„¶ååœ¨å¤æ‚åœºæ™¯ä¸‹ä½¿ç”¨åˆè¯¸å¤šé™åˆ¶(ä½¿ç”¨NATè½¬å‘)
    
-   (2)hosté©±åŠ¨ï¼šå®ƒå°†ä¸ä¸ºDockerå®¹å™¨åˆ›å»ºç½‘ç»œåè®®æ ˆ(ä¸ä¼šåˆ›å»ºç‹¬ç«‹çš„network namespace),å³å®¹å™¨äºå®¿ä¸»æœºå…±ç”¨ä¸€ä¸ªnetwork namespaceå¹¶ä½¿ç”¨å®¿ä¸»æœºçš„ç½‘å¡/IPç«¯å£ç­‰ç­‰ä¿¡æ¯,è¯¥é©±åŠ¨é€‚ç”¨äºå¯¹äºå®¹å™¨é›†ç¾¤è§„æ¨¡ä¸å¤§çš„åœºæ™¯;
    
-   (3)overlayé©±åŠ¨: é‡‡ç”¨IETEæ ‡å‡†çš„VXLANæ–¹å¼,å¹¶ä¸”æ˜¯VXLANä¸­è¢«æ™®éè®¤ä¸ºæœ€é€‚åˆå¤§è§„æ¨¡çš„äº‘è®¡ç®—è™šæ‹ŸåŒ–ç¯å¢ƒçš„SDN controlleræ¨¡å¼,ä½¿ç”¨æ—¶å€™éœ€è¦é¢å¤–çš„é…ç½®å­˜å‚¨æœåŠ¡(ä¾‹å¦‚Consulã€etcdå’Œzookeeper)
    
-   (4)remoteé©±åŠ¨: è¯¥é©±åŠ¨å¹¶æœªåšçœŸæ­£çš„ç½‘ç»œæœåŠ¡å®ç°è€Œæ˜¯è°ƒç”¨äº†ç”¨æˆ·è‡ªè¡Œå®ç°çš„ç½‘ç»œé©±åŠ¨æ’ä»¶,ä½¿libnetworkå®ç°äº†é©±åŠ¨çš„å¯æ’ä»¶åŒ–,æ›´å¥½åœ°æ»¡è¶³äº†ç”¨æˆ·çš„å¤šç§éœ€æ±‚
    
-   (5)nullé©±åŠ¨: å®¹å™¨æ‹¥æœ‰è‡ªå·±çš„ç½‘ç»œå‘½åç©ºé—´,ä½†å¹¶ä¸ä¸ºDockerå®¹å™¨è¿›è¡Œä»»ä½•ç½‘ç»œé…ç½®;å®¹å™¨é™¤äº†network namespaceè‡ªå¸¦çš„loopbackç½‘å¡å,æ²¡æœ‰å…¶ä»–ä»»ä½•ç½‘å¡ã€IPã€è·¯ç”±ç­‰ä¿¡æ¯(éœ€è¦ç”¨æˆ·å¯¹é½é…ç½®)
    

libnetworkå®˜æ–¹ç¤ºä¾‹ï¼š  

![WeiyiGeek.libnetwork](https://i0.hdslb.com/bfs/article/88151ded5ac1bd96480a6a6e7a4ace4499a04a0a.png@942w_452h_progressive.webp)

**(1)ç«¯å£æ˜ å°„å®ç°è®¿é—®å®¹å™¨**  
é€šè¿‡-Pæˆ–è€…-pæ¥æŒ‡å®šç«¯å£,

-   ä½¿ç”¨-Pæ—¶å€™ï¼šä¼šè¿›è¡Œé€‰æ‹© 49000 ~ 49900 ç«¯å£éšæœºåˆ†é…æ˜ å°„;
    
-   ä½¿ç”¨-pæ—¶å€™ï¼šä¼šè®©ä½ æ‚¨è®¾ç½®å›ºå®šä¸å®¹å™¨æ˜ å°„çš„ç«¯å£;
    

æ”¯æŒçš„æ ¼å¼ï¼š

-   hostPort:containerPort < æ˜ å°„åˆ°æœ¬åœ°æŒ‡å®šç«¯å£ä»¥åŠå®¹å™¨ç«¯å£
    
-   ip:hostPort:containerPort < æ˜ å°„åˆ°æœ¬åœ°æŒ‡å®šåœ°å€ä»¥åŠæœ¬åœ°æŒ‡å®šç«¯å£å’Œå®¹å™¨ç«¯å£
    
-   ip::containerPort < æ˜ å°„æœ¬åœ°æŒ‡å®šIPçš„ä»»æ„ç«¯å£å’Œå®¹å™¨ç«¯å£ (æ³¨æ„æ­¤å¤„æ˜¯:ğŸ˜ƒ
    

```
#éšæœºå¼€å¯ç«¯å£
$sudo docker run -d -P centos python app.py 

#æŸ¥çœ‹è½¬å‘çš„ç«¯å£
$docker ps -l   

#æŸ¥çœ‹è¯¦ç»†çš„æ—¥å¿—ä¿¡æ¯
$sudo docker logs -f [NAMES] 

#1.æ˜ å°„æ‰€æœ‰æ¥å£åœ°å€ [å°†æœ¬åœ°çš„5000ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„5000ç«¯å£]
$sudo docker run -d -p 5000:5000 centos python app.py 
#2.æ˜ å°„æŒ‡å®šåœ°å€æŒ‡å®šç«¯å£
$sudo docker run -d -p 127.0.0.1:5000:5000 centos python app.py 
#3.æ˜ å°„æŒ‡å®šåœ°å€åˆ°çš„ä»»æ„ç«¯å£ è¿˜èƒ½ä½¿ç”¨tcpæ ‡è®°æ¥æŒ‡å®šudpç«¯å£
$sudo docker run -d -p 127.0.0.1::5000/tcp centos python app.py 

#æŸ¥çœ‹ç«¯å£æ˜ å°„é…ç½®
$sudo docker port [NAMES] 5000 #å®¹å™¨Port
```

**(2)å®ç°å®¹å™¨é—´é€šä¿¡**  
å®¹å™¨çš„é“¾æ¥(Linking)ç³»ç»Ÿæ˜¯é™¤äº†ç«¯å£æ˜ å°„å¤–çš„å¦ä¸€ç§å¯ä»¥ä¸å®¹å™¨ä¸­åº”ç”¨è¿›è¡Œäº¤æ¢çš„æ–¹å¼;å®ƒä¼šåœ¨æºå’Œæ¥æ”¶å®¹å™¨ä¹‹é—´åˆ›å»ºä¸€ä¸ªéš§é“,æ¥æ”¶å®¹å™¨å¯ä»¥çœ‹åˆ°æºå®¹å™¨æŒ‡å®šçš„ä¿¡æ¯;

Dockerä¸¤ç§æ–¹å¼ä¸ºå®¹å™¨å…¬å¼€è¿æ¥ä¿¡æ¯:

-   1.ç¯å¢ƒå˜é‡
    
-   2.æ›´æ–°/etc/hosts
    

```
#é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“å®¹å™¨,å¯åŠ¨dbå®¹å™¨çš„æ—¶å€™å¹¶æ²¡æœ‰ä½¿ç”¨-pä¸-Pæ ‡è®°ï¼Œé¿å…äº†æš´éœ²æ•°æ®åº“ç«¯å£åˆ°å¤–éƒ¨ç½‘ç»œä¸Š
$sudo docker run -d --name db tranining/postgres

#ä½¿dbå®¹å™¨ä¸webå®¹å™¨å»ºç«‹äº’è”å…³ç³»;
#--link name:alias  å…¶ä¸­namdæ˜¯é“¾æ¥çš„å®¹å™¨çš„åç§°,aliasæ˜¯è¿™ä¸ªé“¾æ¥çš„åˆ«å.
$ sudo docker run -d -P --name web --link db:db training/webapp python app.py

#ä½¿ç”¨ docker ps æ¥æŸ¥çœ‹å®¹å™¨çš„è¿æ¥
$ docker ps 
CONTAINER ID IMAGE COMMAND CREATED STAT
US PORTS NAMES
349169744e49 training/postgres:latest su postgres -c '/usr About a minute ago Up About a minute 5432/tcp db, web/db'
#web/dbè¿™è¡¨ç¤ºweb å®¹å™¨é“¾æ¥åˆ° db å®¹å™¨ï¼Œweb å®¹å™¨å°†è¢«å…è®¸è®¿é—® db å®¹å™¨çš„ä¿¡æ¯ã€‚


#ä½¿ç”¨envå‘½ä»¤æ¥æŸ¥çœ‹webå®¹å™¨çš„ç¯å¢ƒå˜é‡
$sudo docker run --rm --name web1 --link db:db training/webapp env
#èµ·ç‚¹æ±‡æ€»DB_å¼€å¤´çš„ç¯å¢ƒå˜é‡æ˜¯æä¾›webå®¹å™¨è¿æ¥åˆ°dbä½¿ç”¨,å‰ç¼€é‡‡ç”¨å¤§å†™çš„é“¾æ¥åˆ«å
DB_NAME=/web2/db
DB_PORT=tcp://172.17.0.5:5432
DB_PORT_5000_TCP=tcp://172.17.0.5:5432
DB_PORT_5000_TCP_PROTO=tcp
DB_PORT_5000_TCP_PORT=5432
DB_PORT_5000_TCP_ADDR=172.17.0.5


#åŒæ—¶Dockerè¿˜æ·»åŠ hostä¿¡æ¯åˆ°çˆ¶å®¹å™¨çš„/etc/hostsæ–‡ä»¶
$sudo docker run -it --rm --link db:db training/webapp /bin/bash
cat /etc/hosts
```

å®ä¾‹æ¼”ç¤ºï¼š

```
$docker pull nginx
$docker run -d -p 80:80 --name web nginx
$docker container ls -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES
16207d8f2291        nginx               "nginx -g 'daemon ofâ€¦"   19 seconds ago      Up 18 seconds       0.0.0.0:80->80/tcp   web
#å®¹å™¨æœ‰è‡ªå·±çš„å†…éƒ¨ç½‘ç»œå’ŒIPåœ°å€,ä½¿ç”¨docker inspect + å®¹å™¨ID å¯ä»¥è·å–æ‰€æœ‰çš„å˜é‡å€¼;
$docker inspect web
"Gateway": "172.18.0.1",
"IPAddress": "172.18.0.2",
"MacAddress": "02:42:ac:12:00:02",

#ç„¶åæ‰“å¼€80ç«¯å£è¿›è¡Œè®¿é—®é‡‡ç”¨logsæ‰“å°è®¿é—®
$docker logs -f web
218.x.x.xx - - [08/May/2019:15:00:11 +0000] "GET / HTTP/1.1" 304 0 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0" "-"

#è¿›è¡Œlinkå…³è”å®¹å™¨ä½¿ä¹‹èƒ½è¿›è¡Œæ­£å¸¸é€šä¿¡
[root@izwz9biz2m4sd3bb3k38pgz ~]$docker run -d --name web1 --link web:nginx_web alpine cat /etc/hosts
ebe1df8c1fb00462b127d36201d558a9f62507c81faea1ce6c4bf4b5ea6075e3

[root@izwz9biz2m4sd3bb3k38pgz ~]$docker run -d --name web2 --link web:nginx_web alpine env
baa9dfe5f64519eb5ccbd122fc191e0f40118a4ee28385a818f7ffe6e2e03639

[root@izwz9biz2m4sd3bb3k38pgz ~]$docker start -i web1
172.18.0.2      nginx_web 16207d8f2291 web  #æˆåŠŸæ·»åŠ web
172.18.0.3      ebe1df8c1fb0

[root@izwz9biz2m4sd3bb3k38pgz ~]$docker start -i web2
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
HOSTNAME=baa9dfe5f645
NGINX_WEB_PORT=tcp://172.18.0.2:80  #web2ä¹ŸæˆåŠŸæ·»åŠ web
NGINX_WEB_PORT_80_TCP=tcp://172.18.0.2:80
NGINX_WEB_PORT_80_TCP_ADDR=172.18.0.2
NGINX_WEB_PORT_80_TCP_PORT=80
NGINX_WEB_PORT_80_TCP_PROTO=tcp
NGINX_WEB_NAME=/web2/nginx_web
NGINX_WEB_ENV_NGINX_VERSION=1.15.12-1~stretch
NGINX_WEB_ENV_NJS_VERSION=1.15.12.0.3.1-1~stretch
```

![WeiyiGeek.è®¿é—®å®¹å™¨æ˜ å°„å‡ºç½‘ç«™](https://i0.hdslb.com/bfs/article/56ea9eefa81a9e8967219a823df730aea54a7a37.png@942w_402h_progressive.webp)

**(3)libnetworkåº“å®˜æ–¹ç¤ºä¾‹**  
æ‰§è¡Œæµç¨‹ï¼š

```
#dockerå†…ç½®çš„é»˜è®¤é»˜è®¤ç½‘å¡æ˜¯æ˜¯æ— æ³•ä½¿ç”¨docker network rmè¿›è¡Œåˆ é™¤;
$docker network ls
NETWORK ID          NAME                DRIVER              SCOPE
f26c3ed5f7b0        bridge              bridge              local
fd3572aceb38        host                host                local
01da6464c812        none                null                local

#Step 1.åˆ›å»ºåä¸ºbackendã€frontendä¸¤ä¸ªç½‘ç»œ
$docker network create backend
6cde78afe495a310bb27c5e1a50074b20e204bfa72e71bcaf6a4c37feb300b93
$docker network create frontend
63791a62ad5a5fe4aeb5926616b2ea1d65b490bb9fb718824b7cb1c408ae50c1
$docker network create -d bridge test-net
#-dï¼šå‚æ•°æŒ‡å®š Docker ç½‘ç»œç±»å‹ï¼Œæœ‰ bridgeã€overlay/noneã€‚

#Step 2. å°†c1ä¸c2çš„å®¹å™¨åŠ å…¥åˆ°backendç½‘ç»œä¸­,å°†c3å®¹å™¨åŠ å…¥åˆ°frontendç½‘ç»œä¸­
$docker run -itd --name c1 --net backend alpine
729f2abef71ceaf831999d66264d05f78674d9cd2c235f84481a14b366698adb
$docker run -itd --name c2 --net backend alpine
26d47af2d39a1b00f767c60a68cd5f61f1cf5f48652cdcbcb0216968a3185f5e
$docker run -itd --name c3 --net frontend alpine
9cb94f7c66955ba5a95c90d08ce314da0e477f6eddbcea0329309ec36ca5a711


#Step 3. åˆ†åˆ«è¿›å…¥c1å’Œc3å®¹å™¨ä½¿ç”¨pingå‘½ä»¤æµ‹è¯•å…¶ä¸c2çš„è¿é€šæ€§,å› ä¸ºc1å’Œc2éƒ½åœ¨backendç½‘ç»œä¸­,æ‰€ä»¥ä¸¤è€…å¯ä»¥è¿é€šã€‚ä½†æ˜¯å› ä¸ºc3å’Œc2ä¸åœ¨ä¸€ä¸ªç½‘ç»œä¸­,æ‰€ä»¥ä¸¤ä¸ªå®¹å™¨ä¹‹é—´ä¸èƒ½è¿é€šï¼š
# ä½¿ç”¨docker inspect c3 æŸ¥çœ‹IPä¿¡æ¯ï¼š
C1: 172.19.0.2
C2: 172.19.0.3
C3: "IPAddress": "172.20.0.2",

# è¿›å…¥c1å®¹å™¨ping c2é€šã€ping c3ä¸é€šã€‚å…¶å®ƒä¸¤ä¸ªå®¹å™¨å°±ä¸è¿›å…¥æ¼”ç¤ºäº†,å¤§å®¶è‡ªå·±å¯ä»¥è¯•ä¸€ä¸‹ï¼š
# docker exec -it c1 sh
# ip addr
18: eth0@if19: <BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN> mtu 1500 qdisc noqueue state UP
    link/ether 02:42:ac:13:00:02 brd ff:ff:ff:ff:ff:ff
    inet 172.19.0.2/16 brd 172.19.255.255 scope global eth0
# ping c2
PING c2 (172.19.0.3): 56 data bytes
64 bytes from 172.19.0.3: seq=0 ttl=64 time=0.065 ms
64 bytes from 172.19.0.3: seq=1 ttl=64 time=0.050 ms
/ # ping 172.20.0.2
PING 172.20.0.2 (172.20.0.2): 56 data bytes


# Step 4. å°†c2è¿æ¥åŠ å…¥åˆ°frontç½‘ç»œä¸­,ä½¿ç”¨execè¿›å…¥c2ä¸­æŸ¥çœ‹ç½‘å¡ä¿¡æ¯,æµ‹è¯•c2ä¸c3çš„è¿é€šæ€§å,å¯ä»¥å‘ç°ä¸¤è€…å·²ç»è¿é€š
$docker network connect frontend c2
$docker exec -it c2 sh
/ $ ip addr
20: eth0@if21: <BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN> mtu 1500 qdisc noqueue state UP
    link/ether 02:42:ac:13:00:03 brd ff:ff:ff:ff:ff:ff
    inet 172.19.0.3/16 brd 172.19.255.255 scope global eth0
24: eth1@if25: <BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN> mtu 1500 qdisc noqueue state UP
    link/ether 02:42:ac:14:00:03 brd ff:ff:ff:ff:ff:ff
    inet 172.20.0.3/16 brd 172.20.255.255 scope global eth1

/ $ ping c3
PING c3 (172.20.0.2): 56 data bytes
64 bytes from 172.20.0.2: seq=0 ttl=64 time=0.100 ms
```

**(4) è·¨ä¸»æœºå®ç°äº’é€š**  
æè¿°: æ­¤å¤–æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡é€šè¿‡æ·»åŠ è·¯ç”±routeçš„æ–¹å¼è¿›è¡Œè·¨ä¸»æœºå®ç°äº’é€šï¼Œä½†æ˜¯é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬ä¸ä¼šå¦‚æ­¤æ“ä½œï¼Œåªåœ¨ç‰¹æ®Šç¯å¢ƒä¸­ä½¿ç”¨æµ‹è¯•ã€‚

æ¯”å¦‚ï¼šDocker1: 172.18.0.1/24 <--> Gateways <-->Â 192.168.1.99

æ€»ç»“è¯´æ˜ï¼š

-   ç”¨æˆ·å¯ä»¥é“¾æ¥å¤šä¸ªå­å®¹å™¨åˆ°çˆ¶å®¹å™¨ä¸­æ¯”å¦‚è¿æ¥å¤šä¸ªwebåˆ°dbå®¹å™¨ä¸Š;
    
-   å­¦ä¹ é¢å¤–çš„æœºåˆ¶æ¯”å¦‚SDN(è½¯ä»¶å®šä¹‰ç½‘ç»œ)æˆ–è€…NFV(ç½‘ç»œåŠŸèƒ½è™šæ‹ŸåŒ–)çš„ç›¸å…³æŠ€æœ¯
    

æè¿°: å®¹å™¨äº’è” éšç€ Docker ç½‘ç»œçš„å®Œå–„ï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶å°†å®¹å™¨åŠ å…¥è‡ªå®šä¹‰çš„ Docker ç½‘ç»œæ¥è¿æ¥å¤šä¸ªå®¹å™¨ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ --link å‚æ•°

å¦‚ä½•è‡ªå®šä¹‰é…ç½®å®¹å™¨çš„ä¸»æœºåå’Œ DNS å‘¢ï¼Ÿ  
ç­”ï¼šDocker ä¼šé»˜è®¤ç”¨ä¸»æœºä¸Šçš„ /etc/resolv.conf æ¥é…ç½®å®¹å™¨, æ‰€ä»¥å¯ä»¥ç›´æ¥åœ¨å®¿ä¸»æœºä¸Šçš„resolv.confæ–‡ä»¶ä¸­è¿›è¡Œæ›´æ”¹,ä¹Ÿå¯ä»¥åœ¨/etc/docker/daemon.json æ–‡ä»¶ä¸­å¢åŠ DNSé”®å€¼å¯¹æ˜¯ä¸€ä¸ªæ•°ç»„;

```
#æ–°å»ºç½‘ç»œ
docker network create -d bridge my-net
#åˆ†åˆ«å¯åŠ¨ä¸¤ä¸ªå®¹å™¨(ç„¶åè¿›å…¥äº’pingæŸ¥çœ‹)
$docker run -it --rm --name busybox1 --network my-net busybox sh
$docker run -it --rm --name busybox1 --network my-net busybox sh


#ç§˜è¯€å°±æ˜¯ Docker åˆ©ç”¨è™šæ‹Ÿæ–‡ä»¶æ¥æŒ‚è½½å®¹å™¨çš„ 3 ä¸ªç›¸å…³é…ç½®æ–‡ä»¶,åœ¨å®¹å™¨ä¸­ä½¿ç”¨ mount å‘½ä»¤å¯ä»¥çœ‹åˆ°æŒ‚è½½ä¿¡æ¯
#å¯ä»¥è®©å®¿ä¸»ä¸»æœº DNS ä¿¡æ¯å‘ç”Ÿæ›´æ–°åï¼Œæ‰€æœ‰ Docker å®¹å™¨çš„ DNS é…ç½®é€šè¿‡ /etc/resolv.conf æ–‡ä»¶ç«‹åˆ»å¾—åˆ°æ›´æ–°ã€‚
/dev/mapper/cl-root on /etc/resolv.conf type xfs (rw,relatime,attr2,inode64,noquota)
/dev/mapper/cl-root on /etc/hostname type xfs (rw,relatime,attr2,inode64,noquota)
/dev/mapper/cl-root on /etc/hosts type xfs (rw,relatime,attr2,inode64,noquota)
#Docker 1.2.0 å¼€å§‹æ”¯æŒåœ¨è¿è¡Œä¸­çš„å®¹å™¨é‡Œç¼–è¾‘ /etc/hosts, /etc/hostname å’Œ /etc/resolv.conf æ–‡ä»¶ã€‚
#ä½†æ˜¯è¿™äº›ä¿®æ”¹æ˜¯ä¸´æ—¶çš„ï¼Œåªåœ¨è¿è¡Œçš„å®¹å™¨ä¸­ä¿ç•™ï¼Œå®¹å™¨ç»ˆæ­¢æˆ–é‡å¯åå¹¶ä¸ä¼šè¢«ä¿å­˜ä¸‹æ¥ï¼Œä¹Ÿä¸ä¼šè¢« docker commit æäº¤ã€‚

#å®¿ä¸»æœºæ›´æ”¹åç«‹å³ç”Ÿæ•ˆ(å®¹å™¨é‡æ–°è¿›å…¥çš„æ—¶å€™)
$docker start -i 81fa
sh-4.2# cat /etc/resolv.conf
# Generated by NetworkManager
nameserver 192.168.10.254
nameserver 61.128.128.68
nameserver 114.114.114.114
```

**å®¹å™¨è®¿é—®æ§åˆ¶**  
å®¹å™¨çš„è®¿é—®æ§åˆ¶ï¼Œä¸»è¦é€šè¿‡ Linux ä¸Šçš„ iptables é˜²ç«å¢™æ¥è¿›è¡Œç®¡ç†å’Œå®ç°.  
å®¹å™¨è®¿é—®å¤–éƒ¨ç½‘ç»œï¼Œéœ€è¦æœ¬åœ°ç³»ç»Ÿçš„è½¬å‘æ”¯æŒã€‚åœ¨Linux ç³»ç»Ÿä¸­ï¼Œæ£€æŸ¥è½¬å‘æ˜¯å¦æ‰“å¼€ã€‚

```
$sysctl net.ipv4.ip_forward
net.ipv4.ip_forward = 1

#å¦‚æœåœ¨å¯åŠ¨ Docker æœåŠ¡çš„æ—¶å€™è®¾å®š --ip-forward=true, Docker å°±ä¼šè‡ªåŠ¨è®¾å®šç³»ç»Ÿçš„ ip_forward å‚æ•°ä¸º 1ã€‚
$sysctl -w net.ipv4.ip_forward=1
```

å®¹å™¨ä¹‹é—´è®¿é—®éœ€è¦ä¸¤æ–¹é¢çš„æ”¯æŒï¼š

-   å®¹å™¨çš„ç½‘ç»œæ‹“æ‰‘æ˜¯å¦å·²ç»äº’è”ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å®¹å™¨éƒ½ä¼šè¢«è¿æ¥åˆ° docker0 ç½‘æ¡¥ä¸Šã€‚
    
-   æœ¬åœ°ç³»ç»Ÿçš„é˜²ç«å¢™è½¯ä»¶ -- iptables æ˜¯å¦å…è®¸é€šè¿‡ã€‚  
    åŠ¨å®¹å™¨ï¼ˆdocker runï¼‰æ—¶ä½¿ç”¨ --link=CONTAINER\_NAME:ALIAS é€‰é¡¹,å°±ä¼šåœ¨å®¿ä¸»æœºä¸Šæ·»åŠ äº† iptables è§„åˆ™ã€‚
    

```
$ sudo iptables -nL
Chain FORWARD (policy ACCEPT)
target     prot opt source               destination
ACCEPT     tcp  --  172.17.0.2           172.17.0.3           tcp spt:80
ACCEPT     tcp  --  172.17.0.3           172.17.0.2           tcp dpt:80
DROP       all  --  0.0.0.0/0            0.0.0.0/0
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œå®¹å™¨å¯ä»¥ä¸»åŠ¨è®¿é—®åˆ°å¤–éƒ¨ç½‘ç»œçš„è¿æ¥ï¼Œä½†æ˜¯å¤–éƒ¨ç½‘ç»œæ— æ³•è®¿é—®åˆ°å®¹å™¨ã€‚

-   å®¹å™¨è®¿é—®å¤–éƒ¨å®ç°:å®¹å™¨æ‰€æœ‰åˆ°å¤–éƒ¨ç½‘ç»œçš„è¿æ¥ï¼Œæºåœ°å€éƒ½ä¼šè¢« NAT æˆæœ¬åœ°ç³»ç»Ÿçš„ IP åœ°å€
    
-   å¤–éƒ¨è®¿é—®å®¹å™¨å®ç°:å¯ä»¥åœ¨ docker run æ—¶å€™é€šè¿‡ -p æˆ– -P å‚æ•°æ¥å¯ç”¨ã€‚
    

ä¸ç®¡ç”¨é‚£ç§åŠæ³•ï¼Œå…¶å®ä¹Ÿæ˜¯åœ¨æœ¬åœ°çš„ iptable çš„ nat è¡¨ä¸­æ·»åŠ ç›¸åº”çš„è§„åˆ™

```
$sudo iptables -t nat -nL
#å…¶ä¸­ï¼Œä¸Šè¿°è§„åˆ™å°†æ‰€æœ‰æºåœ°å€åœ¨ 172.17.0.0/16 ç½‘æ®µï¼Œç›®æ ‡åœ°å€ä¸ºå…¶ä»–ç½‘æ®µï¼ˆå¤–éƒ¨ç½‘ç»œï¼‰çš„æµé‡åŠ¨æ€ä¼ªè£…ä¸ºä»ç³»ç»Ÿç½‘å¡å‘å‡ºã€‚
#MASQUERADE è·Ÿä¼ ç»Ÿ SNAT çš„å¥½å¤„æ˜¯å®ƒèƒ½åŠ¨æ€ä»ç½‘å¡è·å–åœ°å€ã€‚
Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination
MASQUERADE  all  --  172.17.0.0/16       !172.17.0.0/16


#ä½¿ç”¨ç«¯å£æ˜ å°„çš„æ—¶å€™
chain DOCKER (2 references)
target     prot opt source               destination
DNAT       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:80 to:172.17.0.2:80
```

**docker ç½‘æ¡¥**  
Docker æœåŠ¡é»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ª docker0 ç½‘æ¡¥ï¼ˆå…¶ä¸Šæœ‰ä¸€ä¸ª docker0 å†…éƒ¨æ¥å£ï¼‰ï¼Œå®ƒåœ¨å†…æ ¸å±‚è¿é€šäº†å…¶ä»–çš„ç‰©ç†æˆ–è™šæ‹Ÿç½‘å¡ï¼Œè¿™å°±å°†æ‰€æœ‰å®¹å™¨å’Œæœ¬åœ°ä¸»æœºéƒ½æ”¾åˆ°åŒä¸€ä¸ªç‰©ç†ç½‘ç»œã€‚  
Docker é»˜è®¤æŒ‡å®šäº† docker0 æ¥å£ çš„ IP åœ°å€å’Œå­ç½‘æ©ç ï¼Œè®©ä¸»æœºå’Œå®¹å™¨ä¹‹é—´å¯ä»¥é€šè¿‡ç½‘æ¡¥ç›¸äº’é€šä¿¡ï¼Œå®ƒè¿˜ç»™å‡ºäº† MTUï¼ˆæ¥å£å…è®¸æ¥æ”¶çš„æœ€å¤§ä¼ è¾“å•å…ƒï¼‰ï¼Œé€šå¸¸æ˜¯ 1500 Bytesï¼Œæˆ–å®¿ä¸»ä¸»æœºç½‘ç»œè·¯ç”±ä¸Šæ”¯æŒçš„é»˜è®¤å€¼,å€¼éƒ½å¯ä»¥åœ¨æœåŠ¡å¯åŠ¨çš„æ—¶å€™è¿›è¡Œé…ç½®ã€‚

```
#ç”±äºç›®å‰ Docker ç½‘æ¡¥æ˜¯ Linux ç½‘æ¡¥ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨ brctl show æ¥æŸ¥çœ‹ç½‘æ¡¥å’Œç«¯å£è¿æ¥ä¿¡æ¯ã€‚
$brctl show
bridge name     bridge id               STP enabled     interfaces
docker0         8000.0242f0960e9f       no              veth4fe5b74

#æ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°å®¹å™¨çš„æ—¶å€™ï¼ŒDocker ä»å¯ç”¨çš„åœ°å€æ®µä¸­é€‰æ‹©ä¸€ä¸ªç©ºé—²çš„ IP åœ°å€åˆ†é…ç»™å®¹å™¨çš„ eth0 ç«¯å£ã€‚ä½¿ç”¨æœ¬åœ°ä¸»æœºä¸Š docker0 æ¥å£çš„ IP ä½œä¸ºæ‰€æœ‰å®¹å™¨çš„é»˜è®¤ç½‘å…³ã€‚
$ sudo docker run -i -t --rm base /bin/bash
$ip addr show eth0
$ip route
default via 172.17.42.1 dev eth0
172.17.0.0/16 dev eth0  proto kernel  scope link  src 172.17.0.3

#è‡ªå®šä¹‰ç½‘æ¡¥ï¼š
#ç”¨æˆ·ä¹Ÿå¯ä»¥æŒ‡å®šç½‘æ¡¥æ¥è¿æ¥å„ä¸ªå®¹å™¨,åœ¨å¯åŠ¨ Docker æœåŠ¡çš„æ—¶å€™ï¼Œä½¿ç”¨ -b BRIDGEæˆ–--bridge=BRIDGE æ¥æŒ‡å®šä½¿ç”¨çš„ç½‘æ¡¥ã€‚
1. å¦‚æœæœåŠ¡å·²ç»è¿è¡Œï¼Œé‚£éœ€è¦å…ˆåœæ­¢æœåŠ¡ï¼Œå¹¶åˆ é™¤æ—§çš„ç½‘æ¡¥ã€‚
$ sudo systemctl stop docker
$ sudo ip link set dev docker0 down #å°†ç½‘å¡å¤„äºéå·¥ä½œçŠ¶æ€
$ sudo brctl delbr docker0   #åˆ é™¤é»˜è®¤ç½‘æ¡¥
$ sudo brctl addbr bridge0   #ç„¶ååˆ›å»ºä¸€ä¸ªç½‘æ¡¥ bridge0ã€‚
$ sudo ip addr add 192.168.5.1/24 dev bridge0
$ sudo ip link set dev bridge0 up  #æŸ¥çœ‹ç¡®è®¤ç½‘æ¡¥åˆ›å»ºå¹¶å¯åŠ¨ã€‚
```

æ³¨ï¼šbrctl å‘½ä»¤åœ¨ Debianã€Ubuntu /Centsosé‡‡ç”¨ç›¸åŒçš„åŒ…ä¸­å¯ä»¥ä½¿ç”¨ sudo apt-get install bridge-utils æ¥å®‰è£…ã€‚

**å®è·µæ¡ˆä¾‹ï¼š**  
åˆ›å»ºä¸€ä¸ªç‚¹åˆ°ç‚¹è¿æ¥,ç‚¹åˆ°ç‚¹é“¾è·¯ä¸éœ€è¦å­ç½‘å’Œå­ç½‘æ©ç ã€‚  
é»˜è®¤æƒ…å†µä¸‹ï¼ŒDocker ä¼šå°†æ‰€æœ‰å®¹å™¨è¿æ¥åˆ°ç”± docker0 æä¾›çš„è™šæ‹Ÿå­ç½‘ä¸­,ç”¨æˆ·æœ‰æ—¶å€™éœ€è¦ä¸¤ä¸ªå®¹å™¨ä¹‹é—´å¯ä»¥ç›´è¿é€šä¿¡ï¼Œè€Œä¸ç”¨é€šè¿‡ä¸»æœºç½‘æ¡¥è¿›è¡Œæ¡¥æ¥ã€‚  
è§£å†³åŠæ³•å¾ˆç®€å•ï¼šåˆ›å»ºä¸€å¯¹ peer æ¥å£ï¼Œåˆ†åˆ«æ”¾åˆ°ä¸¤ä¸ªå®¹å™¨ä¸­ï¼Œé…ç½®æˆç‚¹åˆ°ç‚¹é“¾è·¯ç±»å‹å³å¯

```
$docker run -it --rm --net=none --name demo1 alpine sh
39ca23ce4417

$docker run -it --rm --net=none --name demo2 alpine sh
d4b1311349c1

#æ‰¾åˆ°è¿›ç¨‹å·ï¼Œç„¶ååˆ›å»ºç½‘ç»œå‘½åç©ºé—´çš„è·Ÿè¸ªæ–‡ä»¶ã€‚
$docker inspect -f '{{.State.Pid}}' d4b
6742
$docker inspect -f '{{.State.Pid}}' 39c
6807

sudo mkdir -p /var/run/netns
sudo ln -s /proc/6742/ns/net /var/run/netns/6742
sudo ln -s /proc/6807/ns/net /var/run/netns/6807

#åˆ›å»ºä¸€å¯¹A B peer æ¥å£ï¼Œç„¶åé…ç½®è·¯ç”±
$ sudo ip link add A type veth peer name B

$ sudo ip link set A netns 6742
$ sudo ip netns exec 6742 ip addr add 10.1.1.1/32 dev A
$ sudo ip netns exec 6742 ip link set A up
$ sudo ip netns exec 6742 ip route add 10.1.1.2/32 dev A

$ sudo ip link set B netns 6807
$ sudo ip netns exec 6807 ip addr add 10.1.1.2/32 dev B
$ sudo ip netns exec 6807 ip link set B up
$ sudo ip netns exec 6807 ip route add 10.1.1.1/32 dev B

#ç°åœ¨è¿™ 2 ä¸ªå®¹å™¨å°±å¯ä»¥ç›¸äº’ ping é€šï¼Œå¹¶æˆåŠŸå»ºç«‹è¿æ¥ã€‚ç‚¹åˆ°ç‚¹é“¾è·¯ä¸éœ€è¦å­ç½‘å’Œå­ç½‘æ©ç ã€‚
å®¹å™¨$ ip addr
```

![WeiyiGeek.ç‚¹åˆ°ç‚¹é€šä¿¡](https://i0.hdslb.com/bfs/article/97ab3dd8753990f8d2cc0b3b742cd45a32deedc8.png@942w_234h_progressive.webp)

è‡³æ­¤æœ¬èŠ‚å®Œæ¯•ï¼Œæ•¬è¯·æœŸå¾…ä¸‹ä¸€å°èŠ‚å†…å®¹ã€‚

Dockerå®¹å™¨æŠ€æœ¯å…¥é—¨å®è·µç³»åˆ—å†å²å·²å‘å¸ƒæ–‡ç« ï¼ˆç‚¹å‡»å³å¯è¿›å…¥ï¼‰ï¼š

[1.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹Dockerå®¹å™¨æŠ€æœ¯åŸºç¡€çŸ¥è¯†ä»‹ç»](https://www.bilibili.com/read/cv15180540)

[2.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹Dockerå®¹å™¨ç¯å¢ƒå®‰è£…å®è·µ](https://www.bilibili.com/read/cv15181036)

[3.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹Dockerå®¹å™¨ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µä»‹ç»](https://www.bilibili.com/read/cv15181760)

[4.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹Dockerå®¹å™¨æ•°æ®æŒä¹…åŒ–ä»‹ç»ä¸å®è·µ](https://www.bilibili.com/read/cv15182308)

![](https://i0.hdslb.com/bfs/article/4adb9255ada5b97061e610b682b8636764fe50ed.png@progressive.webp)

> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€ã€master#weiyigeek.topã€‘æˆ–è€…Â ä¸ªäººå…¬ä¼—å·ã€WeiyiGeekã€‘è”ç³»æˆ‘ã€‚

![](https://i0.hdslb.com/bfs/article/02db465212d3c374a43c60fa2625cc1caeaab796.png@progressive.webp)

æ›´å¤šæ–‡ç« æ¥æºäºã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘ ä¸ªäººåšå®¢ã€‚

åšå®¢åœ°å€: https://weiyigeek.topÂ 

![](https://i0.hdslb.com/bfs/article/9a9cef9d789c08c7d7cb209475b46586777c9d26.png@942w_579h_progressive.webp)

è¡¡é‡äººç”Ÿçš„ç¤¾ä¼šä»·å€¼çš„æ ‡å‡†æ˜¯ä¸ªä½“å¯¹ç¤¾ä¼šå’Œä»–äººæ‰€ä½œçš„è´¡çŒ®ã€‚

ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ï¼Œè½¬ä¸ªå‘ã€‘ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œè°¢è°¢ï¼ã€‚

-   echoÂ Â "ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"
    
-   printf("%s",Â "ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")
    
-   fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")Â Â 
    
-   System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")
    
-   console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")