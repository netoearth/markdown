Bç«™å…³æ³¨ã€Œ[**WeiyiGeek**](https://space.bilibili.com/385802642/dynamic)ã€[**ç‚¹æˆ‘ï¼Œç‚¹æˆ‘**](https://space.bilibili.com/385802642/dynamic)

è®¾ä¸ºã€Œ**ç‰¹åˆ«å…³æ³¨**ã€ï¼Œæ¯å¤©å¸¦ä½ ç©è½¬ç½‘ç»œå®‰å…¨è¿ç»´ã€åº”ç”¨å¼€å‘ã€ç‰©è”ç½‘IOTå­¦ä¹ ï¼

GIF

![](https://i0.hdslb.com/bfs/article/4a10568f28aa362fc3ddc7f871b07daf847767da.gif)

å¸…å“¥ï¼ˆé“ä»”ï¼‰ã€ç¾å¥³ï¼Œç‚¹ä¸ªå…³æ³¨åç»­ä¸è¿·è·¯ï¼

**æœ¬ç« ç›®å½•**

![](https://i0.hdslb.com/bfs/article/4aa545dccf7de8d4a93c2b2b8e3265ac0a26d216.png@progressive.webp)

-   0x01 ä½¿ç”¨ nerdctl å·¥å…·é…åˆ Containerd æ›¿ä»£ Docker å®¹å™¨
    

-   1.ä½¿ç”¨æ‡’åŠ è½½åŠ é€Ÿå›¾åƒæ‹‰å–ï¼ˆeStargzï¼‰
    
-   2.é…ç½®é«˜é€Ÿçš„ rootless æ¨¡å¼
    
-   ä»‹ç» nerdctl å·¥å…·
    
-   å®‰è£… nerdctl å·¥å…·
    
-   ä½¿ç”¨ nerdctl å·¥å…·
    
-   å·¥å…· nerdctl å‘½ä»¤
    
-   æœ‰è¶£çš„å®éªŒåŠŸèƒ½
    
-   å®è·µ.ä½¿ç”¨ containerd & nerdctl å·¥å…·å¿«é€Ÿéƒ¨ç½² redis æ•°æ®åº“æœåŠ¡å®¹å™¨
    
-   å…¥å‘å‡ºå‘
    

![](https://i0.hdslb.com/bfs/article/4aa545dccf7de8d4a93c2b2b8e3265ac0a26d216.png@progressive.webp)

ä½œè€…: WeiyiGeek

åŸæ–‡åœ°å€ï¼šhttps://blog.weiyigeek.top/2021/6-30-581.html

![](https://i0.hdslb.com/bfs/article/4aa545dccf7de8d4a93c2b2b8e3265ac0a26d216.png@progressive.webp)

æè¿°: Containerd æ˜¯ä¸€ä¸ªå·¥ä¸šçº§æ ‡å‡†çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œå®ƒå¼ºè°ƒç®€å•æ€§ã€å¥å£®æ€§å’Œå¯ç§»æ¤æ€§ã€‚Containerd å¯ä»¥åœ¨å®¿ä¸»æœºä¸­ç®¡ç†å®Œæ•´çš„å®¹å™¨ç”Ÿå‘½å‘¨æœŸï¼šå®¹å™¨é•œåƒçš„ä¼ è¾“å’Œå­˜å‚¨ã€å®¹å™¨çš„æ‰§è¡Œå’Œç®¡ç†ã€å­˜å‚¨å’Œç½‘ç»œç­‰

å­¦è¿‡Dockerçš„ç«¥é‹éƒ½çŸ¥é“, æˆ‘ä»¬åˆ©ç”¨docker-cliä¸docker-composeå·¥å…·èƒ½å¸®åŠ©å¿«é€Ÿçš„è¿›è¡Œé•œåƒå’Œå®¹å™¨çš„ç›¸å…³æ“ä½œã€‚è‡ªä» Containerd å‘å¸ƒ 1.5 ä»¥åï¼ŒKubernetes çš„CRIæ¥å£ä½¿ç”¨ Containerd æ¥æ›¿ä»£ dockershim æ—¶, æˆ‘ä»¬ä¾¿å¯ä»¥ä½¿ç”¨ nerdctl å·¥å…·(æ›¿ä»£ docker cli) é…åˆ Containerd çš„æƒ…å†µä¸‹åŸºæœ¬å·²ç»å¯ä»¥æ›¿æ¢æ‰ Docker å’Œ Docker Compose;

**ä»€ä¹ˆæ˜¯nerdctl?**  
nerdctl æ˜¯ ä¸ Docker å…¼å®¹çš„CLI for Containerdï¼Œå…¶æ”¯æŒComposeã€Rootlessã€eStargzã€OCIcryptå’ŒIPFSï¼Œä¸dockerå‘½ä»¤è¡Œè¯­æ³•ç±»ä¼¼ï¼Œæ‰€ä»¥å…¶ä¸Šæ‰‹ä½¿ç”¨éå¸¸ç®€å•ğŸ˜Šã€‚

nerdctl å®˜æ–¹å‘å¸ƒåŒ…åŒ…å«ä¸¤ä¸ªå®‰è£…ç‰ˆæœ¬:

> Minimal: ä»…åŒ…å« nerdctl äºŒè¿›åˆ¶æ–‡ä»¶ä»¥åŠ rootless æ¨¡å¼ä¸‹çš„è¾…åŠ©å®‰è£…è„šæœ¬  
> Full: çœ‹åå­—å°±èƒ½çŸ¥é“æ˜¯ä¸ªå…¨é‡åŒ…ï¼Œå…¶åŒ…å«äº† Containerdã€CNIã€runcã€BuildKit ç­‰å®Œæ•´ç»„ä»¶

é¡¹ç›®åœ°å€ï¼š GitHub - containerd/nerdctl: Docker-compatible CLI for containerd, with support for Compose (Â https://github.com/containerd/nerdctlÂ )

æœ€æ–°nerdctlç‰ˆæœ¬releasesä¸‹è½½åœ°å€:Â https://github.com/containerd/nerdctl/releases

Step 1.ä»Github Releaseé¡µé¢ä¸­ä¸‹è½½é€‚ç”¨äºä½ ç³»ç»Ÿçš„ Full åŒ…ï¼Œå½“å‰æœ€æ–°ç‰ˆæœ¬ã€2022å¹´4æœˆ25æ—¥ 11:22:59ã€‘ä¸ºv.0.19.0ã€‚

```
# æ–­ç‚¹ä¸åå°ä¸‹è½½
# å…¨é‡åŒ…
wget -c -b https://github.com/containerd/nerdctl/releases/download/v0.19.0/nerdctl-full-0.19.0-linux-amd64.tar.gz

# ä»…åŒ…å« nerdctl äºŒè¿›åˆ¶
wget -c -b https://github.com/containerd/nerdctl/releases/download/v0.19.0/nerdctl-0.19.0-linux-amd64.tar.gz
```

Step 2.ä¸‹è½½å®Œæˆåè§£å‹ç„¶åè¿›è¡Œç›¸åº”çš„å®‰è£…æ“ä½œã€‚

```
# 1.å®‰è£…ä»…åŒ…å« nerdctl äºŒè¿›åˆ¶æ–‡ä»¶åŒ… ï¼ˆMinimal - ä¸æ¨èï¼‰
tar Cxzvvf /usr/local/bin nerdctl-0.19.0-linux-amd64.tar.gz
  # -rwxr-xr-x root/root  27578368 2022-04-22 12:03 nerdctl
  # -rwxr-xr-x root/root     21562 2022-04-22 12:02 containerd-rootless-setuptool.sh
  # -rwxr-xr-x root/root      7032 2022-04-22 12:02 containerd-rootless.sh
cd /usr/local/bin && ./containerd-rootless-setuptool.sh install # æ³¨æ„ä¸èƒ½ä»¥rootç”¨æˆ·è¿è¡Œ


# 2.å®‰è£… nerdctl å…¨é‡åŒ… (Full - æ¨è)
tar Cxzvvf /usr/local nerdctl-full-0.19.0-linux-amd64.tar.gz
  # drwxr-xr-x 0/0               0 2022-04-22 12:16 bin/
  # -rwxr-xr-x 0/0        25371420 2015-10-21 08:00 bin/buildctl
  # -rwxr-xr-x 0/0        39651613 2015-10-21 08:00 bin/buildkitd
  # drwxr-xr-x 0/0               0 2022-04-22 12:16 share/doc/nerdctl-full/
  # -rw-r--r-- 0/0            1135 2022-04-22 12:16 share/doc/nerdctl-full/README.md
  # -rw-r--r-- 0/0            5425 2022-04-22 12:16 share/doc/nerdctl-full/SHA256SUMS

# 3.åˆå§‹åŒ–å®‰è£…ä»¥å…¨é‡åŒ…ä¸ºä¾‹,å¦‚å‡ºç°å¦‚ä¸‹å‘½ä»¤è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚
/usr/local/bin$ ./containerd-rootless-setuptool.sh install
  # + systemctl --user enable containerd.service
  # Created symlink /home/weiyigeek/.config/systemd/user/default.target.wants/containerd.service â†’ /home/weiyigeek/.config/systemd/user/containerd.service.
  # [INFO] Installed "containerd.service" successfully.
  # [INFO] To control "containerd.service", run: `systemctl --user (start|stop|restart) containerd.service`
  # [INFO] To run "containerd.service" on system startup automatically, run: `sudo loginctl enable-linger weiyigeek`
  # [INFO] ------------------------------------------------------------------------------------------
  # [INFO] Use `nerdctl` to connect to the rootless containerd.
  # [INFO] You do NOT need to specify $CONTAINERD_ADDRESS explicitly.
```

Step 3.å¯åŠ¨ containerd å’Œ buildkitd æœåŠ¡ã€‚

```
# å¯åŠ¨ containerd &&  éªŒè¯æœåŠ¡çŠ¶æ€
systemctl enable --now containerd && systemctl restart containerd && systemctl status containerd

# å¯ç”¨ BuildKit ä¸ºäº†æ„å»º Dockerfileï¼Œæ‚¨éœ€è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ç”¨ BuildKitã€‚
/usr/local/bin$ CONTAINERD_NAMESPACE=default containerd-rootless-setuptool.sh install-buildkit-containerd
  # [INFO] Creating "/home/weiyigeek/.config/systemd/user/default-buildkit.service"
  # [INFO] Starting systemd unit "default-buildkit.service"
  # + systemctl --user start default-buildkit.service
  # + sleep 3
  # + systemctl --user --no-pager --full status default-buildkit.service
  # â— default-buildkit.service - BuildKit (Rootless)
  #     Loaded: loaded (/home/weiyigeek/.config/systemd/user/default-buildkit.service; disabled; vendor preset: enabled)
  #     Active: active (running) since Mon 2022-04-25 13:05:25 CST; 3s ago
  #   Main PID: 329750 (buildkitd)
  #     CGroup: /user.slice/user-1000.slice/user@1000.service/default-buildkit.service
  #             â””â”€329750 buildkitd --addr=unix:///run/user/1000/buildkit-default/buildkitd.sock --root=/home/weiyigeek/.local/share/buildkit-default --containerd-worker-namespace=default

  # Apr 25 13:05:25 node-2 systemd[327840]: Started BuildKit (Rootless).
  # Apr 25 13:05:26 node-2 containerd-rootless-setuptool.sh[329750]: time="2022-04-25T13:05:26+08:00" level=info msg="found worker \"ffl4pd8j6x7fh6t9o85a70l11\", labels=map[org.mobyproject.buildkit.worker.containerd.namespace:default org.mobyproject.buildkit.worker.containerd.uuid:4f029882-9edc-4c20-ab49-0363abe0d40e org.mobyproject.buildkit.worker.executor:containerd org.mobyproject.buildkit.worker.hostname:node-2 org.mobyproject.buildkit.worker.network:host org.mobyproject.buildkit.worker.snapshotter:overlayfs], platforms=[linux/amd64 linux/amd64/v2 linux/amd64/v3 linux/386]"
  # Apr 25 13:05:26 node-2 containerd-rootless-setuptool.sh[329750]: time="2022-04-25T13:05:26+08:00" level=info msg="found 1 workers, default=\"ffl4pd8j6x7fh6t9o85a70l11\""
  # Apr 25 13:05:26 node-2 containerd-rootless-setuptool.sh[329750]: time="2022-04-25T13:05:26+08:00" level=warning msg="currently, only the default worker can be used."
  # Apr 25 13:05:26 node-2 containerd-rootless-setuptool.sh[329750]: time="2022-04-25T13:05:26+08:00" level=info msg="running server on /run/user/1000/buildkit-default/buildkitd.sock"
  # + systemctl --user enable default-buildkit.service
  # Created symlink /home/weiyigeek/.config/systemd/user/default.target.wants/default-buildkit.service â†’ /home/weiyigeek/.config/systemd/user/default-buildkit.service.
  # [INFO] Installed "default-buildkit.service" successfully.
  # [INFO] To control "default-buildkit.service", run: `systemctl --user (start|stop|restart) default-buildkit.service`
```

Step 4.æŸ¥çœ‹nerdctlå·¥å…·æ‰§è¡Œç»“æœåŠå…¶ç‰ˆæœ¬ï¼Œè‡³æ­¤å®‰è£…å®Œæ¯•

```
$ nerdctl --version
nerdctl version 0.19.0
```

æè¿°: åœ¨æŸä¸€ä¸ªç”¨æˆ·æ‰§è¡Œæ—¶nerdctlå‘½ä»¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å…¶å®¶ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªå¦‚ä¸‹è·¯å¾„æ–‡ä»¶`/home/weiyigeek/.config/nerdctl/nerdctl.toml`,è¯¥æ–‡ä»¶å¯é…ç½®åŒ…å«nerdctlç›¸å…³é…ç½®é¡¹ç›®ã€‚

**ç®€è¿°å°è¯•**

-   Step 1.é•œåƒæ‹‰å–ä¸æŸ¥çœ‹
    

```
$ nerdctl pull hello-world:latest
  # docker.io/library/hello-world:latest:                                             resolved       |++++++++++++++++++++++++++++++++++++++|
  # index-sha256:10d7d58d5ebd2a652f4d93fdd86da8f265f5318c6a73cc5b6a9798ff6d2b2e67:    done           |++++++++++++++++++++++++++++++++++++++|
  # manifest-sha256:f54a58bc1aac5ea1a25d796ae155dc228b3f0e11d046ae276b39c4bf2f13d8c4: done           |++++++++++++++++++++++++++++++++++++++|
  # config-sha256:feb5d9fea6a5e9606aa995e879d862b825965ba48de054caab5ef356dc6b3412:   done           |++++++++++++++++++++++++++++++++++++++|
  # layer-sha256:2db29710123e3e53a794f2694094b9b4338aa9ee5c40b930cb8063a1be392c54:    done           |++++++++++++++++++++++++++++++++++++++|
  # elapsed: 34.3s                                                                    total:  6.9 Ki (205.0 B/s)

$ nerdctl image ls
  # REPOSITORY     TAG       IMAGE ID        CREATED           PLATFORM       SIZE        BLOB SIZE
  # hello-world    latest    10d7d58d5ebd    31 seconds ago    linux/amd64    20.0 KiB    6.9 KiB
```

-   Step 2.è¿è¡Œæ‹‰å–çš„ hello-world é•œåƒ
    

```
# åˆ›å»ºå¹¶åå°è¿è¡Œä¸€ä¸ªåä¸º hello-containerd çš„å®¹å™¨
$ nerdctl run -d --privileged --name hello-containerd hello-world:latest
  # 17cc212e69b2387b0aa1e4c4e679e41072eeeb14f909fff2acdb24d3c1033c0d

# æŸ¥çœ‹ hello-containerd å®¹å™¨æ—¥å¿—
$ nerdctl logs hello-containerd
  # Hello from Docker!
  # This message shows that your installation appears to be working correctly.
  # .......
  # Share images, automate workflows, and more with a free Docker ID: https://hub.docker.com/
  # For more examples and ideas, visit:https://docs.docker.com/get-started/
```

-   Step 3.æŸ¥çœ‹åˆ›å»ºçš„å®¹å™¨ç›¸å…³ä¿¡æ¯ä»¥åŠåˆ é™¤å®¹å™¨ã€‚
    

```
# å®¹å™¨æŸ¥çœ‹
$ nerdctl ps -a
  # CONTAINER ID    IMAGE                                   COMMAND     CREATED          STATUS                      PORTS    NAMES
  # 17cc212e69b2    docker.io/library/hello-world:latest    "/hello"    2 minutes ago    Exited (0) 2 minutes ago             hello-containerd

# å®¹å™¨è¯¦ç»†ä¿¡æ¯
$ nerdctl inspect 17cc212e69b2
[
  {
    "Id": "17cc212e69b2387b0aa1e4c4e679e41072eeeb14f909fff2acdb24d3c1033c0d",
    "Created": "2022-04-25T05:13:16.690822727Z",
    "Path": "/hello",
    "Args": null,
    "State": { "Status": "exited", "Running": false, "Paused": false,"Pid": 330226, "ExitCode": 0,"FinishedAt": "2022-04-25T05:13:17.251972898Z"},
    "Image": "docker.io/library/hello-world:latest",
    "ResolvConfPath": "/home/weiyigeek/.local/share/nerdctl/1935db59/containers/default/17cc212e69b2387b0aa1e4c4e679e41072eeeb14f909fff2acdb24d3c1033c0d/resolv.conf",
    "HostnamePath": "/home/weiyigeek/.local/share/nerdctl/1935db59/containers/default/17cc212e69b2387b0aa1e4c4e679e41072eeeb14f909fff2acdb24d3c1033c0d/hostname",
    "LogPath": "/home/weiyigeek/.local/share/nerdctl/1935db59/containers/default/17cc212e69b2387b0aa1e4c4e679e41072eeeb14f909fff2acdb24d3c1033c0d/17cc212e69b2387b0aa1e4c4e679e41072eeeb14f909fff2acdb24d3c1033c0d-json.log",
    "Name": "hello-containerd",
    "Driver": "overlayfs",
    "Platform": "linux",
    "AppArmorProfile": "",
    "Mounts": null,
    "NetworkSettings": null
  }
]

# ç§»é™¤ hello-containerd å®¹å™¨
$ nerdctl rm hello-containerd
hello-containerd
```

-   Step 4.åˆ é™¤æŒ‡å®š hello-world é•œåƒ
    

```
$ nerdctl rmi hello-world
Untagged: docker.io/library/hello-world:latest@sha256:10d7d58d5ebd2a652f4d93fdd86da8f265f5318c6a73cc5b6a9798ff6d2b2e67
Deleted: sha256:e07ee1baac5fae6a26f30cabfe54a36d3402f96afda318fe0a96cec4ca393359
```

-   Step 5.æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‹‰å– nginx:alpine é•œåƒå¹¶åˆ›å»ºã€åå°è¿è¡Œnginxå®¹å™¨ã€è¿›å…¥å®¹å™¨å†…éƒ¨ã€‚
    

```
$ sudo nerdctl run -d --name nginx -p 80:80 nginx:alpine
  # docker.io/library/nginx:alpine:                                                   resolved       |++++++++++++++++++++++++++++++++++++++|
  # index-sha256:5a0df7fb7c8c03e4158ae9974bfbd6a15da2bdfdeded4fb694367ec812325d31:    done           |++++++++++++++++++++++++++++++++++++++|
  # manifest-sha256:efc09388b15fb423c402f0b8b28ca70c7fd20fe31f8d7531ae1896bbb4944999: done           |++++++++++++++++++++++++++++++++++++++|
  # config-sha256:51696c87e77e4ff7a53af9be837f35d4eacdb47b4ca83ba5fd5e4b5101d98502:   done           |++++++++++++++++++++++++++++++++++++++|
  # layer-sha256:4071be97c256d6f5ab0e05ebdebcfec3d0779a5e199ad0d71a5fccba4b3e2ce4:    done           |++++++++++++++++++++++++++++++++++++++|
  # layer-sha256:df9b9388f04ad6279a7410b85cedfdcb2208c0a003da7ab5613af71079148139:    done           |++++++++++++++++++++++++++++++++++++++|
  # layer-sha256:5867cba5fcbd3ae827c5801e76d20e7dc91cbb626ac5c871ec6c4d04eb818b16:    done           |++++++++++++++++++++++++++++++++++++++|
  # layer-sha256:4b639e65cb3ba47e77db93f93c6625a62ba1b9eec99160b254db380115ae009d:    done           |++++++++++++++++++++++++++++++++++++++|
  # layer-sha256:061ed9e2b9762825b9869a899a696ce8b56e7e0ec1e1892b980969bf7bcda56a:    done           |++++++++++++++++++++++++++++++++++++++|
  # layer-sha256:bc19f3e8eeb1bb75268787f8689edec9a42deda5cdecdf2f95b3c6df8eb57a48:    done           |++++++++++++++++++++++++++++++++++++++|
  # elapsed: 33.7s                                                                    total:  9.7 Mi (294.8 KiB/s)
  # 98eb2f1d4639b173dc21c30e40be5f3e2c410e4ca325b6bd6bafcaab46ab6c11

# æŸ¥çœ‹åˆ›å»ºçš„nginxå®¹å™¨
$ sudo nerdctl ps
  # CONTAINER ID    IMAGE                             COMMAND                   CREATED              STATUS    PORTS                 NAMES
  # 98eb2f1d4639    docker.io/library/nginx:alpine    "/docker-entrypoint.â€¦"    About an hour ago    Up        0.0.0.0:80->80/tcp    nginx

# è¿›å…¥nginxå®¹å™¨å†…éƒ¨
$ nerdctl exec -it nginx -- sh
/ # whoami
root
/ # ip addr
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: eth0@if4: <BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN> mtu 1500 qdisc noqueue state UP
    link/ether ee:e6:a6:9a:07:48 brd ff:ff:ff:ff:ff:ff
    inet 10.4.0.2/24 brd 10.4.0.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::ece6:a6ff:fe9a:748/64 scope link
       valid_lft forever preferred_lft forever

/usr/share/nginx/html # hostname > index.html
/usr/share/nginx/html # ip addr >> index.html

# è®¿é—®åˆ›å»ºçš„nginxå®¹å™¨ æˆ–è€… æµè§ˆå™¨è®¿é—® 10.10.107.227 å®¿ä¸»æœº
$ curl -I localhost
```

-   Step 6.nginx å®¹å™¨è¯¦ç»†ä¿¡æ¯æŸ¥çœ‹ä¸å®¹å™¨åœæ­¢ã€åˆ é™¤ã€‚
    

```
$ nerdctl inspect --format "{{ .Name }} {{ .Id }}" nginx
  # nginx 98eb2f1d4639b173dc21c30e40be5f3e2c410e4ca325b6bd6bafcaab46ab6c11

$ nerdctl stop nginx
  # nginx
$ nerdctl ps  -a
  # CONTAINER ID    IMAGE                             COMMAND                   CREATED        STATUS                      PORTS                 NAMES
  # 98eb2f1d4639    docker.io/library/nginx:alpine    "/docker-entrypoint.â€¦"    2 hours ago    Exited (0) 4 seconds ago    0.0.0.0:80->80/tcp    nginx

$ nerdctl rm nginx
nginx
```

![WeiyiGeek.nerdctl-containerd](https://i0.hdslb.com/bfs/article/7c4b8f3a9c209a8f6b0a8086e76de9ad9ea43dfe.png@942w_504h_progressive.webp)

æ¸©é¦¨æç¤º: ä¸çŸ¥è¯»è€…æ˜¯å¦å‘ç°, å…¶å­å‘½ä»¤åŠå…¶ä½¿ç”¨æ–¹æ³•ä¸dockerå®¢æˆ·ç«¯å·¥å…·åŸºæœ¬æ˜¯ç±»ä¼¼çš„ï¼Œæ‰€ä»¥å‰é¢è¯´åˆ°å…¶å­¦ä¹ æˆæœ¬è¾ƒä½, ç†Ÿæ‚‰dockerçš„æœ‹å‹å¯ä»¥å¿«é€Ÿä¸Šæ‰‹

æè¿° : nerdctl æ˜¯ containerd çš„å‘½ä»¤è¡Œç•Œé¢çš„å·¥å…·ã€‚

**å‘½ä»¤å‚æ•°:**

```
# Usage:
  nerdctl [flags]
  nerdctl [command]

# Management commands:
  apparmor    Manage AppArmor profiles
  builder     Manage builds
  container   Manage containers
  image       Manage images
  ipfs        Distributing images on IPFS
  namespace   Manage containerd namespaces
  network     Manage networks
  system      Manage containerd
  volume      Manage volumes
Commands:
  build       Build an image from a Dockerfile. Needs buildkitd to be running.
  commit      Create a new image from a container changes
  completion  Generate the autocompletion script for the specified shell
  compose     Compose
  cp          Copy files/folders between a running container and the local filesystem.
  create      Create a new container. Optionally specify "ipfs://" or "ipns://" scheme to pull image from IPFS.
  events      Get real time events from the server
  exec        Run a command in a running container
  help        Help about any command
  history     Show the history of an image
  images      List images
  info        Display system-wide information
  inspect     Return low-level information on objects.
  kill        Kill one or more running containers
  load        Load an image from a tar archive or STDIN
  login       Log in to a Docker registry
  logout      Log out from a Docker registry
  logs        Fetch the logs of a container. Currently, only containers created with `nerdctl run -d` are supported.
  pause       Pause all processes within one or more containers
  port        List port mappings or a specific mapping for the container
  ps          List containers
  pull        Pull an image from a registry. Optionally specify "ipfs://" or "ipns://" scheme to pull image from IPFS.
  push        Push an image or a repository to a registry. Optionally specify "ipfs://" or "ipns://" scheme to push image to IPFS.
  restart     Restart one or more running containers
  rm          Remove one or more containers
  rmi         Remove one or more images
  run         Run a command in a new container. Optionally specify "ipfs://" or "ipns://" scheme to pull image from IPFS.
  save        Save one or more images to a tar archive (streamed to STDOUT by default)
  start       Start one or more running containers
  stats       Display a live stream of container(s) resource usage statistics.
  stop        Stop one or more running containers
  tag         Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE
  top         Display the running processes of a container
  unpause     Unpause all processes within one or more containers
  update      Update one or more running containers
  version     Show the nerdctl version information
  wait        Block until one or more containers stop, then print their exit codes.

# Flags:
  -H, --H string                 Alias of --address (default "/run/containerd/containerd.sock")
  -a, --a string                 Alias of --address (default "/run/containerd/containerd.sock")
      --address string           containerd address, optionally with "unix://" prefix [$CONTAINERD_ADDRESS] (default "/run/containerd/containerd.sock")
      --cgroup-manager string    Cgroup manager to use ("cgroupfs"|"systemd") (default "none")
      --cni-netconfpath string   cni config directory [$NETCONFPATH] (default "/home/weiyigeek/.config/cni/net.d")
      --cni-path string          cni plugins binary directory [$CNI_PATH] (default "/usr/local/libexec/cni")
      --data-root string         Root directory of persistent nerdctl state (managed by nerdctl, not by containerd) (default "/home/weiyigeek/.local/share/nerdctl")
      --debug                    debug mode
      --debug-full               debug mode (with full output)
  -h, --help                     help for nerdctl
      --host string              Alias of --address (default "/run/containerd/containerd.sock")
      --hosts-dir strings        A directory that contains <HOST:PORT>/hosts.toml (containerd style) or <HOST:PORT>/{ca.cert, cert.pem, key.pem} (docker style) (default [/home/weiyigeek/.config/containerd/certs.d,/home/weiyigeek/.config/docker/certs.d])
      --insecure-registry        skips verifying HTTPS certs, and allows falling back to plain HTTP
  -n, --n string                 Alias of --namespace (default "default") , æ”¯æŒåç§°ç©ºé—´ã€‚
      --namespace string         containerd namespace, such as "moby" for Docker, "k8s.io" for Kubernetes [$CONTAINERD_NAMESPACE] (default "default")
      --snapshotter string       containerd snapshotter [$CONTAINERD_SNAPSHOTTER] (default "overlayfs")
      --storage-driver string    Alias of --snapshotter (default "overlayfs")
  -v, --version                  version for nerdctl
```

**nerdctl ä½¿ç”¨ç¤ºä¾‹**

-   ä»“åº“è®¤è¯
    

```
$ nerdctl login -u weiyigeek index.docker.io
  # Enter Password:
  # WARNING: Your password will be stored unencrypted in /root/.docker/config.json. Configure a credential helper to remove this warning. See
  # https://docs.docker.com/engine/reference/commandline/login/#credentials-store
  # Login Succeeded

$ nerdctl logout
  # Removing login credentials for https://index.docker.io/v1/
```

-   é•œåƒæ“ä½œ
    

```
# æ‹‰å–
nerdctl pull docker.io/library/nginx:alpine
nerdctl -n k8s.io pull docker.io/library/nginx:alpine

# æŸ¥çœ‹
nerdctl -n default image ls
nerdctl -n default inspect nginx:alpine

# åˆ é™¤
nerdctl -n default rmi nginx:alpine
```

-   å®¹å™¨æ“ä½œ
    

```
# åˆ›å»ºè¿è¡Œå®¹å™¨
sudo nerdctl -n default run -d --name nginx -p 80:80 nginx:alpine
sudo nerdctl -n k8s.io run -d --privileged --restart=always --name rancher -p 80:80 -p 443:443 docker.io/cnrancher/rancher:v2.4.17-ent

# æŸ¥çœ‹å®¹å™¨
sudo nerdctl -n k8s.io ps -a
sudo nerdctl -n k8s.io inpsect rancher

# è¿›å…¥å®¹å™¨å†…éƒ¨
sudo nerdctl -n k8s.io exec rancher -- sh

# åœæ­¢å®¹å™¨
sudo nerdctl -n k8s.io stop rancher

# åˆ é™¤å®¹å™¨
sudo nerdctl -n k8s.io rm rancher
```

æè¿°: æˆ‘åœ¨éªŒè¯ç¯å¢ƒä¸­ä½¿ç”¨æ—¶å‘ç°ç‰¹åˆ«å¸å¼•äººçš„æœ€æ–°åŠŸèƒ½ä¸€ä¸ªæ˜¯å›¾åƒå¿«é€Ÿæ‹‰å–ï¼ˆeStargzï¼‰, å¦å¤–ä¸€ä¸ªæ˜¯é«˜é€Ÿ rootless æ¨¡å¼ã€‚

æè¿°: åœ¨è¿‡å»çš„ä¸€å¹´ä¸­ï¼Œå¯ä»¥åœ¨å®¹å™¨ç›¸å…³çš„å·¥å…·ï¼ˆåŒ…æ‹¬`Kubernetesï¼Œcontainedï¼Œnerdctlï¼ŒCRI-Oï¼ŒPodmanï¼ŒBuildKitï¼ŒKaniko`ç­‰ï¼‰ä¸Šä½¿ç”¨eStargzé•œåƒçš„æ‡’æ‹‰å–åŠŸèƒ½, åœ¨2021å¹´æ‡’æ‹‰å–å°†æˆä¸ºè¶Šæ¥è¶Šæ™®éçš„é•œåƒåˆ†å‘æŠ€æœ¯ï¼Œå¹¶ä¸”æ­£åœ¨æŠŠeStargzå¢åŠ åˆ°OCIå®¹å™¨é•œåƒè§„èŒƒå½“ä¸­ã€‚

ä» 1.4 ç‰ˆå¼€å§‹ Containered æ”¯æŒæ‡’æ‹‰å–, Stargz Snapshotter æ˜¯ä½¿ containerd èƒ½å¤Ÿå¤„ç†eStargzçš„æ’ä»¶ã€‚ è¿™æ˜¯ä¸€ç§ç”¨äºæ‡’æ‹‰å–çš„é•œåƒåˆ†å‘æŠ€æœ¯ã€‚è¿™ä½¿å®¹å™¨è¿è¡Œæ—¶æ— éœ€ç­‰å¾…æ•´ä¸ªé•œåƒå†…å®¹å³å¯å¯åŠ¨å®¹å™¨ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼ŒæŒ‰éœ€è·å–å¿…è¦çš„å†…å®¹å—ï¼ˆä¾‹å¦‚å•ä¸ªæ–‡ä»¶ï¼‰ã€‚è¿™æ ·å¯ä»¥å°†å®¹å™¨å¯åŠ¨å»¶è¿Ÿä»æ•°åç§’ç¼©çŸ­åˆ°æœ€ä½³çš„å‡ ç§’ã€‚

![WeiyiGeek.eStargzåŠ é€Ÿæ‹‰å–](https://i0.hdslb.com/bfs/article/0dfebf62f8da366ced607ba525bbf35c9bd95026.png@942w_500h_progressive.webp)

é…ç½®å‚è€ƒåœ°å€:Â https://github.com/containerd/nerdctl/blob/master/docs/rootless.md#stargz-snapshotter

æˆ‘ä»¬å°†ç»§ç»­æ‰§è¡Œå¦‚ä¸‹æ­¥éª¤, ä»¥å¯ç”¨å›¾åƒæ‹‰å–çš„åŠ é€Ÿï¼ˆå»¶è¿Ÿæ‹‰å–ï¼‰, å³åŠ é€Ÿé•œåƒæ‹‰å–ã€‚

**å®è·µæ“ä½œ**

1.å®‰è£…ä¸å¯ç”¨ Stargz å¿«ç…§ç¨‹åºã€‚

```
/usr/local/bin$ containerd-rootless-setuptool.sh install-stargz
[INFO] Creating "/home/cqzk/.config/systemd/user/stargz-snapshotter.service"
[INFO] Starting systemd unit "stargz-snapshotter.service"
+ systemctl --user start stargz-snapshotter.service
+ sleep 3
+ systemctl --user --no-pager --full status stargz-snapshotter.service
...........
[INFO] Installed "stargz-snapshotter.service" successfully.
[INFO] To control "stargz-snapshotter.service", run: `systemctl --user (start|stop|restart) stargz-snapshotter.service`
[INFO] Add the following lines to "/home/cqzk/.config/containerd/config.toml" manually, and then run `systemctl --user restart containerd.service`:
### BEGIN ###
[proxy_plugins]
  [proxy_plugins."stargz"]
    type = "snapshot"
    address = "/run/user/1000/containerd-stargz-grpc/containerd-stargz-grpc.sock"
###  END  ###
[INFO] Set `export CONTAINERD_SNAPSHOTTER="stargz"` to use the stargz snapshotter.
```

2.å‡†å¤‡ä¸€ä¸ªåŒ…å«ä»¥ä¸‹ containerd å†…å®¹çš„é…ç½®, ä¸ºäº†å®‰å…¨æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸€ä¸ªç”¨æˆ·, ä¾‹å¦‚ä½¿ç”¨ nerdctl çš„ç”¨æˆ·çš„ UID ä¸º 1000 çš„é…ç½®æ”¾ç½®ä½ç½®ä¸º`/run/user/1000`ã€‚

```
# ç¡®è®¤æ–¹æ³•å½“å‰ç”¨æˆ·UID
$ echo $UID
1000

# åœ¨ containerd é…ç½®æ–‡ä»¶ä¸­å¯ç”¨è¯¥æ’ä»¶
tee ~/.config/containerd/config.toml  <<'EOF'
# Plug stargz snapshotter into containerd
# Containerd recognizes stargz snapshotter through specified socket address.
[proxy_plugins]
  [proxy_plugins."stargz"]
    type = "snapshot"
    # NOTE: replace "1000" with your actual UID
    address = "/run/user/1000/containerd-stargz-grpc/containerd-stargz-grpc.sock"

# Use stargz snapshotter through CRI

EOF
```

3.é‡æ–°å¯åŠ¨ restargz-snapshotter ä¸ containerd ä»¥ä½¿é…ç½®æ›´æ”¹ç”Ÿæ•ˆã€‚

```
systemctl daemon-reload
systemctl --user start restargz-snapshotter.service && systemctl --user restart containerd.service
systemctl status stargz-snapshotter.service && systemctl status containerd.service

â— stargz-snapshotter.service - stargz snapshotter (Rootless)
     Loaded: loaded (/home/cqzk/.config/systemd/user/stargz-snapshotter.service; enabled; vendor preset: enabled)
     Active: active (running) since Mon 2022-04-25 16:48:56 CST; 7s ago
   Main PID: 360664 (containerd-star)
     CGroup: /user.slice/user-1000.slice/user@1000.service/stargz-snapshotter.service
             â””â”€360664 containerd-stargz-grpc -address /run/user/1000/containerd-stargz-grpc/containerd-stargz-grpc.sock -root /home/cqzk/.local/share/containerd-stargz-grpc -config /home/cqzk/.config/container>
Apr 25 16:48:56 node-2 systemd[358295]: Started stargz snapshotter (Rootless).
```

4.æ‚¨å¯ä»¥é€‰æ‹©æ‰§è¡Œä»¥ä¸‹å‘½ä»¤,å¹¶æŒ‡å®šä½¿ç”¨`--snapshotter=stargz`è¿›è¡Œå¿«é€Ÿå›¾åƒæ‹‰å–ã€‚

```
export CONTAINERD_SNAPSHOTTER="stargz"
nerdctl run --snapshotter=stargz ghcr.io/stargz-containers/python:3.10-esgz python -c "print('hello')"
```

æè¿°: Rootlessæ¨¡å¼å…è®¸ä½ åœ¨æ²¡æœ‰ç‰¹æƒçš„æƒ…å†µä¸‹è¿è¡Œå®¹å™¨ï¼Œå…·æœ‰å®‰å…¨ä¼˜åŠ¿ï¼Œä½†å®ƒçš„ç¼ºç‚¹æ˜¯å®¹å™¨å¤–çš„é€šä¿¡é€Ÿåº¦æ¯”ç‰¹æƒ Rootful æ¨¡å¼æ…¢ã€‚

ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ bypass4netns, ä½¿å¾— Rootless çš„å®¹å™¨å¤–é€šä¿¡é€Ÿåº¦å°†æ¯” Rootful æ›´å¿«, æ“ä½œå¦‚ä¸‹æ‰€ç¤º:

1.å®‰è£…ä¸å¯ç”¨ bypass4netns

```
/usr/local/bin$ containerd-rootless-setuptool.sh install-bypass4netnsd
```

2.æ‚¨å¯ä»¥é€‰æ‹©æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä½¿ç”¨å¿«é€Ÿæ— æ ¹åŠŸèƒ½å¯åŠ¨å®¹å™¨å’Œä»¥ä¸‹`--label nerdctl/bypass4netns=true`å‚æ•°å¿«é€Ÿå›¾åƒæ‹‰å–ã€‚

```
$ nerdctl run --label nerdctl/bypass4netns=true ghcr.io/stargz-containers/python:3.10-esgz python -c "print('hello')"
```

**Step 1.å‡†å¤‡ redis æ•°æ®åº“é…ç½®æ–‡ä»¶æå…¶ç›¸å…³ç›®å½•**

```
mkdir -vp /app/redis/data
tee /app/redis/redis.conf <<'EOF'
# ç»‘å®šä»»æ„æ¥å£ã€æœåŠ¡ç«¯å£ã€åå°è¿è¡Œã€‚
bind 0.0.0.0
port 6379
# å®¹å™¨é‡Œå¿…é¡»è®¾ç½®ä¸ºno
daemonize no
supervised auto

# redisæœåŠ¡pidè¿›ç¨‹æ–‡ä»¶å
pidfile "/var/run/redis.pid"

# å…³é—­ä¿æŠ¤æ¨¡å¼ï¼Œå¹¶é…ç½®ä½¿ç”¨å¯†ç è®¿é—®
protected-mode no
requirepass "123456"
# echo -e "weiyigeek"|sha256sum
# requirepass 097575a79efcd7ea7b1efa2bcda78a4fc7cbd0820736b2f2708e72c3d21f8b61

# æ•°æ®æ–‡ä»¶ä¿å­˜è·¯å¾„ï¼Œrdb/AOFæ–‡ä»¶ä¹Ÿä¿å­˜åœ¨è¿™é‡Œ
dir "/data"

# æ—¥å¿—æ–‡ä»¶è®°å½•æ–‡ä»¶(notice / verbose)
# logfile "/logs/redis.log"
# loglevel verbose

# æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°
maxclients 10000

# å®¢æˆ·ç«¯è¿æ¥ç©ºé—²å¤šä¹…åæ–­å¼€è¿æ¥ï¼Œå•ä½ç§’ï¼Œ0è¡¨ç¤ºç¦ç”¨
timeout 60
tcp-keepalive 60

# Redis æ•°æ®æŒä¹…åŒ–(rdb/aof)é…ç½®
# RDB æ–‡ä»¶å
dbfilename "dump.rdb"
# æ•°æ®è‡ªåŠ¨ä¿å­˜è„šæœ¬æ¡ä»¶ä¾‹å¦‚300sä¸­æœ‰10keyå‘ç”Ÿå˜åŒ–
save 300 10
save 60 10000
# å¯¹RDBæ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼Œå»ºè®®ä»¥ï¼ˆç£ç›˜ï¼‰ç©ºé—´æ¢ï¼ˆCPUï¼‰æ—¶é—´ã€‚
rdbcompression yes
# ç‰ˆæœ¬5çš„RDBæœ‰ä¸€ä¸ªCRC64ç®—æ³•çš„æ ¡éªŒå’Œæ”¾åœ¨äº†æ–‡ä»¶çš„æœ€åã€‚è¿™å°†ä½¿æ–‡ä»¶æ ¼å¼æ›´åŠ å¯é ã€‚
rdbchecksum yes
# RDBè‡ªåŠ¨è§¦å‘ç­–ç•¥æ˜¯å¦å¯ç”¨ï¼Œé»˜è®¤ä¸ºyes
rdb-save-incremental-fsync yes

# AOFå¼€å¯
appendonly yes
# AOFæ–‡ä»¶å
appendfilename "appendonly.aof"
# å¯é€‰å€¼ alwaysï¼Œ everysecï¼Œnoï¼Œå»ºè®®è®¾ç½®ä¸ºeverysec
appendfsync everysec

# Redisé£é™©å‘½ä»¤é‡å‘½å
# rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52
rename-command FLUSHDB b840fc02d524045429941cc15f59e41cb7be6c53
rename-command FLUSHALL b840fc02d524045429941cc15f59e41cb7be6c54
rename-command EVAL b840fc02d524045429941cc15f59e41cb7be6c55
rename-command DEBUG b840fc02d524045429941cc15f59e41cb7be6c56
# rename-command SHUTDOWN SHUTDOWN
EOF
```

Step 2.æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œå¿«é€Ÿåˆ›å»ºå®¹å™¨å¹¶è¿è¡ŒredisæœåŠ¡ã€‚

```
$ nerdctl run -d -p 6379:6379 \
 -v /app/redis/redis.conf:/etc/redis/redis.conf \
 -v /app/redis/data:/data \
 --name redis-server redis:6.2.6-alpine3.15 redis-server /etc/redis/redis.conf
5e854a58087ae1bba5a661b2941474560cbecc37f54c7f4e7a28afbaed6aebf0
```

Step 3.æŸ¥çœ‹åˆ›å»ºçš„å®¹å™¨å¹¶éªŒè¯redisæœåŠ¡æ˜¯å¦æ­£å¸¸ã€‚

```
$ nerdctl ps
CONTAINER ID    IMAGE                                       COMMAND                   CREATED           STATUS    PORTS                     NAMES
5e854a58087a    docker.io/library/redis:6.2.6-alpine3.15    "docker-entrypoint.sâ€¦"    42 seconds ago    Up        0.0.0.0:6379->6379/tcp    redis-server

$ nerdctl logs redis-server
1:C 25 Apr 2022 13:22:59.597 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
1:C 25 Apr 2022 13:22:59.597 # Redis version=6.2.6, bits=64, commit=00000000, modified=0, pid=1, just started
1:C 25 Apr 2022 13:22:59.597 # Configuration loaded


# å¦‚ä¸‹è¿”å›ï¼Œè¡¨ç¤º redis æœåŠ¡çŠ¶æ€æ˜¯æ­£å¸¸çš„
$ nerdctl exec -it redis-server redis-cli -a 123456 ping
PONG
$ nerdctl exec -it redis-server redis-cli -a 123456 info
# Server
redis_version:6.2.6
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:63421500bb103677
redis_mode:standalone
os:Linux 5.4.0-96-generic x86_64
arch_bits:64
multiplexing_api:epoll
atomicvar_api:atomic-builtin
```

Step 4.è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç”¨telnetå·¥å…·è¿æ¥åˆ›å»ºçš„rediså®¹å™¨ä¸­çš„redisæ•°æ®åº“æœåŠ¡ã€‚

```
$ telnet 10.10.107.227 6379
Trying 10.10.107.227...
Connected to 10.10.107.227.
Escape character is '^]'.
auth 123456  # è®¤è¯
+OK
ping   # æœåŠ¡éªŒè¯
+PONG
set name weiyigeek # è®¾ç½® å­—ç¬¦ä¸² ç±»å‹çš„key
+OK
get name  # è·å– key çš„å€¼
$9
weiyigeek
```

-   é”™è¯¯1.å®‰è£…nerdctlï¼ˆMinimalï¼‰æ—¶æ‰§è¡Œcontainerd-rootless-setuptool.shè„šæœ¬å®‰è£…æ—¶æŠ¥`[ERROR] Refusing to install rootless containerd as the root user`é”™è¯¯  
    è§£å†³åŠæ³•: è¯·åˆ‡æ¢åˆ°æ™®é€šç”¨æˆ·æ‰§è¡Œã€‚
    
-   é”™è¯¯2.å®‰è£…nerdctlï¼ˆMinimalï¼‰æ—¶æ‰§è¡Œcontainerd-rootless-setuptool.shè„šæœ¬å®‰è£…æ—¶æŠ¥`containerd-rootless-setuptool.sh: 110: rootlesskit: Permission denied`é”™è¯¯
    

```
/usr/local/bin$ containerd-rootless-setuptool.sh install
[INFO] Checking RootlessKit functionality
/usr/local/bin/containerd-rootless-setuptool.sh: 110: rootlesskit: Permission denied
```

é—®é¢˜åŸå› : ç”±äºæœªå®‰è£… rootlesskit ç›¸å…³ä¾èµ–å·¥å…·  
è§£å†³åŠæ³•: æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…æ“ä½œÂ `apt install -y rootlesskit rootlessctl`

-   é”™è¯¯3.å®‰è£…nerdctl (full) æ—¶æ‰§è¡Œcontainerd-rootless-setuptool.shè„šæœ¬å®‰è£…æ—¶æŠ¥`exec: "newuidmap": executable file not found in $PATH`é”™è¯¯
    

```
./containerd-rootless-setuptool.sh install
[INFO] Checking RootlessKit functionality
[rootlesskit:parent] error: failed to setup UID/GID map: newuidmap 328299 [0 1000 1 1 100000 65536] failed: : exec: "newuidmap": executable file not found in $PATH
```

é—®é¢˜åŸå› : newuidmap åœ¨æ²¡æœ‰å®‰è£…çš„ç¯å¢ƒä¸‹ä¼šå‡ºç°ä¸Šè¿°é”™è¯¯ï¼Œæ‰€ä»¥æ‰§è¡Œaptå‘½ä»¤å®‰è£…uidmapè½¯ä»¶åŒ…ã€‚  
è§£å†³ç‰ˆæœ¬:Â `sudo apt install uidmap`

![](https://i0.hdslb.com/bfs/article/4aa545dccf7de8d4a93c2b2b8e3265ac0a26d216.png@progressive.webp)

åŸæ–‡åœ°å€ï¼šhttps://blog.weiyigeek.top/2021/6-30-581.html

![](https://i0.hdslb.com/bfs/article/4aa545dccf7de8d4a93c2b2b8e3265ac0a26d216.png@progressive.webp)

æœ¬æ–‡è‡³æ­¤å®Œæ¯•ï¼Œæ›´å¤šæŠ€æœ¯æ–‡ç« ï¼Œå°½æƒ…æœŸå¾…ä¸‹ä¸€ç« èŠ‚ï¼

![](https://i0.hdslb.com/bfs/article/4adb9255ada5b97061e610b682b8636764fe50ed.png@progressive.webp)

**å·²å‘å¸ƒçš„ç›¸å…³å†å²æ–‡ç« ï¼ˆç‚¹å‡»å³å¯è¿›å…¥ï¼‰**

[1.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹Containerdå®¹å™¨è¿è¡Œæ—¶åŸºç¡€ä»‹ç»ä¸Ubuntuç³»ç»Ÿä¸­å®‰è£…é…ç½®å®è·µ](https://www.bilibili.com/read/cv16292700)

[2.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹Containerdå®¹å™¨è¿è¡Œæ—¶å®è·µå°è¯•ä¸å®¢æˆ·ç«¯crictlå·¥å…·ä»‹ç»ä½¿ç”¨](https://www.bilibili.com/read/cv16293193)

[3.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹Containerdå®¹å™¨è¿è¡Œæ—¶å¸¸è§„é…ç½®é¡¹æµ…æä¸å®è·µæŒ‡å—](https://www.bilibili.com/read/cv16314691)

![](https://i0.hdslb.com/bfs/article/4adb9255ada5b97061e610b682b8636764fe50ed.png@progressive.webp)

[1.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹å¿«é€Ÿæ‹¥æŠ±ä¸‹ä¸€ä»£å®¹å™¨å¼•æ“Podmanæ¥æ›¿ä»£Dockerå®¹å™¨](https://www.bilibili.com/read/cv15723446)

[2.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹å¿«é€Ÿæ‹¥æŠ±ä¸‹ä¸€ä»£å®¹å™¨å¼•æ“Podmanå¸¸ç”¨å‘½ä»¤æµ…æä¸ç®€å•é…ç½®](https://www.bilibili.com/read/cv15723670)

![](https://i0.hdslb.com/bfs/article/4adb9255ada5b97061e610b682b8636764fe50ed.png@progressive.webp)

[1.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹KubernetesåŸºç¡€å…¥é—¨å­¦ä¹ æ¦‚è¿°ç³»ç»Ÿæ¶æ„åŠç»„ä»¶æµ…æ](https://www.bilibili.com/read/cv16194345)

[2.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹KubernetesåŸºç¡€æ¦‚å¿µåè¯æµ…æä¸ç®€å•å®è·µæŒ‡å—](https://www.bilibili.com/read/cv16196478)

[3.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹Kuberneteså…¥é—¨å®è·µCentOSç³»ç»Ÿä¸Šå®‰è£…éƒ¨ç½²K8Så•æ§åˆ¶å¹³é¢ç¯å¢ƒ](https://www.bilibili.com/read/cv16278040)

[4.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹Kuberneteså…¥é—¨å®è·µCentOSç³»ç»Ÿä¸Šæ‰‹åŠ¨å®‰è£…éƒ¨ç½²K8Sé›†ç¾¤ç¯å¢ƒ](https://www.bilibili.com/read/cv16278293)

[](https://www.bilibili.com/read/preview/16278587)[5.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹Kuberneteså…¥é—¨å®è·µUbuntuç³»ç»Ÿä¸Šå®‰è£…éƒ¨ç½²K8Så•æ§åˆ¶å¹³é¢ç¯å¢ƒ](https://www.bilibili.com/read/preview/16278587)

[6.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹Kuberneteså…¥é—¨å®è·µUbuntuç³»ç»Ÿä¸Šå®‰è£…éƒ¨ç½²é«˜å¯ç”¨çš„K8Sé›†ç¾¤ç¯å¢ƒ](https://www.bilibili.com/read/cv16278860)

[7.æˆ‘åœ¨Bç«™å­¦äº‘åŸç”Ÿä¹‹Kuberneteså…¥é—¨å®è·µåŸºäºcontainerdå®¹å™¨è¿è¡Œæ—¶å®‰è£…éƒ¨ç½²K8Sé›†ç¾¤ç¯å¢ƒ](https://www.bilibili.com/read/cv16293585)

![](https://i0.hdslb.com/bfs/article/4adb9255ada5b97061e610b682b8636764fe50ed.png@progressive.webp)

> æ¬¢è¿å„ä½å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œå¦‚æ–‡ç« æœ‰è¯¯è¯·åœ¨ä¸‹æ–¹ç•™ä¸‹æ‚¨å®è´µçš„ç»éªŒçŸ¥è¯†ï¼Œä¸ªäººé‚®ç®±åœ°å€ã€master#weiyigeek.topã€‘æˆ–è€…Â ä¸ªäººå…¬ä¼—å·ã€WeiyiGeekã€‘è”ç³»æˆ‘ã€‚

![](https://i0.hdslb.com/bfs/article/02db465212d3c374a43c60fa2625cc1caeaab796.png@progressive.webp)

æ›´å¤šæ–‡ç« æ¥æºäºã€WeiyiGeek Blog - ä¸ºäº†èƒ½åˆ°è¿œæ–¹ï¼Œè„šä¸‹çš„æ¯ä¸€æ­¥éƒ½ä¸èƒ½å°‘ã€‘ ä¸ªäººåšå®¢ã€‚

**ä¸ªäººä¸»é¡µ:**Â ã€Â https://weiyigeek.topÂ ã€‘  

**åšå®¢åœ°å€:**Â ã€Â https://blog.weiyigeek.topÂ ã€‘

![](https://i0.hdslb.com/bfs/article/813dfe5de3d7e2dc0ff2ce8c38ec097255fe26b1.png@942w_480h_progressive.webp)

https://weiyigeek.top - Always keep a beginner's mind, don't forget the beginner's mind

ä¸“æ ä¹¦å†™ä¸æ˜“ï¼Œå¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªä¸“æ è¿˜ä¸é”™çš„ï¼Œè¯·ç»™è¿™ç¯‡ä¸“æ ã€ç‚¹ä¸ªèµã€æŠ•ä¸ªå¸ã€æ”¶ä¸ªè—ã€å…³ä¸ªæ³¨ï¼Œè½¬ä¸ªå‘ã€ç•™ä¸ªè¨€ã€‘ï¼Œè¿™å°†å¯¹æˆ‘çš„è‚¯å®šï¼Œè°¢è°¢ï¼ã€‚

-   echoÂ Â "ã€ç‚¹ä¸ªèµã€‘ï¼ŒåŠ¨åŠ¨ä½ é‚£ç²—å£®çš„æ‹‡æŒ‡æˆ–è€…èŠŠèŠŠç‰æ‰‹ï¼Œäº²ï¼"
    
-   printf("%s",Â "ã€æŠ•ä¸ªå¸ã€‘ï¼Œä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼ŒæŠ•ä¸ªç¡¬å¸è¡Œä¸è¡Œï¼Œäº²ï¼")
    
-   fmt.Printf("ã€æ”¶ä¸ªè—ã€‘ï¼Œé˜…åå³ç„šä¸åƒç°ï¼Œäº²ï¼")
    
-   System.out.println("ã€å…³ä¸ªæ³¨ã€‘ï¼Œåç»­æµè§ˆæŸ¥çœ‹ä¸è¿·è·¯å“Ÿï¼Œäº²ï¼")
    
-   console.info("ã€è½¬ä¸ªå‘ã€‘ï¼Œè®©æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·å­¦ä¹ äº¤æµï¼Œäº²ï¼")
    
-   cout << "ã€ç•™ä¸ªè¨€ã€‘ï¼Œæ–‡ç« å†™å¾—å¥½ä¸å¥½ã€æœ‰æ²¡æœ‰é”™è¯¯ï¼Œä¸€å®šè¦ç•™è¨€å“Ÿï¼Œäº²! " << endl;
    

GIF

![](https://i0.hdslb.com/bfs/article/11a629d1bc4369dc810216c5dedac871136167d7.gif@1s.webp)

è°¢è°¢ï¼Œå„ä½å¸…å“¥ã€ç¾å¥³å››è¿æ”¯æŒï¼ï¼è¿™å°±æ˜¯æˆ‘çš„åŠ¨åŠ›ï¼

Â æ›´å¤šç½‘ç»œå®‰å…¨ã€ç³»ç»Ÿè¿ç»´ã€åº”ç”¨å¼€å‘ã€å…¨æ ˆæ–‡ç« ï¼Œå°½åœ¨ã€ä¸ªäººåšå®¢ -Â https://blog.weiyigeek.topã€‘ç«™ç‚¹ï¼Œè°¢è°¢æ”¯æŒï¼