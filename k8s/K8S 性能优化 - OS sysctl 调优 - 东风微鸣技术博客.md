<table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br></pre></td><td><pre><code><span># Kubernetes Settings</span><br><span>vm.max_map_count</span> = <span>262144</span><br><span>kernel.softlockup_panic</span> = <span>1</span><br><span>kernel.softlockup_all_cpu_backtrace</span> = <span>1</span><br><span>net.ipv4.ip_local_reserved_ports</span> = <span>30000</span>-<span>32767</span><p><span># Increase the number of connections</span><br><span>net.core.somaxconn</span> = <span>32768</span></p><p><span># Maximum Socket Receive Buffer</span><br><span>net.core.rmem_max</span> = <span>16777216</span></p><p><span># Maximum Socket Send Buffer</span><br><span>net.core.wmem_max</span> = <span>16777216</span></p><p><span># Increase the maximum total buffer-space allocatable</span><br><span>net.ipv4.tcp_wmem</span> = <span>4096</span> <span>87380</span> <span>16777216</span><br><span>net.ipv4.tcp_rmem</span> = <span>4096</span> <span>87380</span> <span>16777216</span></p><p><span># Increase the number of outstanding syn requests allowed</span><br><span>net.ipv4.tcp_max_syn_backlog</span> = <span>8096</span></p><p><span># For persistent HTTP connections</span><br><span>net.ipv4.tcp_slow_start_after_idle</span> = <span>0</span></p><p><span># Allow to reuse TIME_WAIT sockets for new connections</span><br><span># when it is safe from protocol viewpoint</span><br><span>net.ipv4.tcp_tw_reuse</span> = <span>1</span></p><p><span># Max number of packets that can be queued on interface input</span><br><span># If kernel is receiving packets faster than can be processed</span><br><span># this queue increases</span><br><span>net.core.netdev_max_backlog</span> = <span>16384</span></p><p><span># Increase size of file handles and inode cache</span><br><span>fs.file-max</span> = <span>2097152</span></p><p><span># Max number of inotify instances and watches for a user</span><br><span># Since dockerd runs as a single user, the default instances value of 128 per user is too low</span><br><span># e.g. uses of inotify: nginx ingress controller, kubectl logs -f</span><br><span>fs.inotify.max_user_instances</span> = <span>8192</span><br><span>fs.inotify.max_user_watches</span> = <span>524288</span></p><p><span># Additional sysctl flags that kubelet expects</span><br><span>vm.overcommit_memory</span> = <span>1</span><br><span>kernel.panic</span> = <span>10</span><br><span>kernel.panic_on_oops</span> = <span>1</span></p><p><span># Prevent docker from changing iptables: https://github.com/kubernetes/kubernetes/issues/40182</span><br><span>net.ipv4.ip_forward</span>=<span>1</span></p></code><p><i></i>INI</p></pre></td></tr></tbody></table>